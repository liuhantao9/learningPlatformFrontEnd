{"ast":null,"code":"var _jsxFileName = \"/Users/hantaoliu/Projects/Learning-Platform/techleak/client/src/components/userProfile/userProfileComponent/headingSection.jsx\";\nimport React from \"react\";\nimport { connect } from \"react-redux\";\nimport axios from \"../../../axios/axios-blogs\";\nimport profile from \"../../../assets/img/Portrait_Placeholder.png\";\nimport getReputation from \"../../../utils/getSumFromArray\";\n\nclass HeadingSection extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      selectedFile: null,\n      loading: false,\n      editing: false,\n      bio: this.props.bio\n    };\n\n    this.fileHandler = e => {\n      this.setState({\n        selectedFile: e.target.files[0]\n      });\n      var reader = new FileReader();\n\n      reader.onload = function () {\n        var dataURL = reader.result;\n        var output = document.getElementById(\"profile\");\n        output.src = dataURL;\n        output.width = \"128px\";\n      };\n\n      reader.readAsDataURL(e.target.files[0]);\n    };\n\n    this.handleEditPop = () => {\n      this.setState({\n        editing: true\n      });\n    };\n\n    this.onChange = e => {\n      e.preventDefault();\n      this.setState({\n        bio: e.target.value\n      });\n    };\n\n    this.handleEdit = () => {\n      const token = localStorage.getItem(\"token\");\n      const headers = {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Token \".concat(token),\n          withCredentials: true\n        }\n      };\n      axios.patch(\"/api/users/bio/\".concat(this.props.userId), {\n        bio: this.state.bio\n      }, headers).then(res => {\n        this.setState({\n          editing: false\n        });\n      });\n      this.props.updateBio(this.state.bio);\n    };\n\n    this.handleUpload = () => {\n      if (this.state.selectedFile) {\n        const data = new FormData();\n        data.append(\"avatar\", this.state.selectedFile);\n        this.setState({\n          loading: true\n        });\n        const token = localStorage.getItem(\"token\");\n        const headers = {\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: \"Token \".concat(token),\n            withCredentials: true\n          }\n        };\n        axios.patch(\"/api/users/profile/\".concat(this.props.userId), data, headers).then(res => {\n          this.setState({\n            loading: false\n          });\n          this.setState({\n            selectedFile: null\n          });\n          this.props.updateAvatar(res.data.avatar);\n          axios.patch(\"\".concat(process.env.REACT_APP_BACKEND_SERVER, \"/api/posts/avatar/\").concat(this.props.userId), {\n            avatar: this.props.avatar\n          }, headers);\n        }).catch(err => {\n          this.setState({\n            loading: false\n          });\n          this.setState({\n            selectedFile: null\n          });\n        });\n      }\n    };\n  }\n\n  render() {\n    const editInput = React.createElement(\"div\", {\n      className: \"media-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"field\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"control\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, React.createElement(\"textarea\", {\n      className: \"textarea\",\n      value: this.state.bio,\n      onChange: this.onChange,\n      placeholder: \"Add a comment...\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"field\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"control\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"button\",\n      onClick: this.handleEdit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, \"Save\"))));\n    return React.createElement(\"div\", {\n      className: \"section profile-heading\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"columns is-mobile is-multiline\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"column is-2-tablet is-6-mobile name\",\n      style: {\n        textAlign: \"center\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"header-icon user-profile-image\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, React.createElement(\"figure\", {\n      className: \"image is-square\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      id: \"profile\",\n      src: this.props.avatar || profile,\n      style: {\n        filter: \"blur(\".concat(this.state.loading ? 2 : 0, \"px)\")\n      },\n      width: \"128px\",\n      alt: \"profile\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"file is-small\",\n      style: {\n        float: \"left\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      class: \"file-label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      class: \"file-input\",\n      ode: true,\n      type: \"file\",\n      name: \"resume\",\n      onChange: this.fileHandler,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      class: \"file-cta\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      class: \"file-icon\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      class: \"fas fa-upload\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    })), React.createElement(\"span\", {\n      class: \"file-label\",\n      style: {\n        display: \"inline-flex\",\n        textOverflow: \"ellipsis\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }, \"Select Image\")))), React.createElement(\"button\", {\n      class: \"button is-active is-small \".concat(this.state.loading ? \"is-loading\" : \"\"),\n      style: {\n        display: \"inline-block\",\n        backgroundColor: \"whitesmoke\",\n        color: \"#4a4a4a\",\n        borderColor: \"#dbdbdb\",\n        borderRadius: \"4px\",\n        fontSize: \"0.75em\",\n        overflow: \"hidden\",\n        textOverflow: \"ellipsis\"\n      },\n      onClick: this.handleUpload,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, \"Upload\"))), React.createElement(\"div\", {\n      className: \"column is-6-tablet is-6-mobile name\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"title is-bold\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, this.props.username), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      className: \"button is-primary is-outlined\",\n      id: \"edit-preferences\",\n      style: {\n        margin: \"5px 0\"\n      },\n      onClick: this.handleEditPop,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, \"Edit Biography\")), this.state.editing ? editInput : React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }, this.props.bio)), React.createElement(\"div\", {\n      className: \"column is-1-tablet is-2-mobile has-text-centered\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"column is-1-tablet is-4-mobile has-text-centered\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"stat-val\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }, this.props.knowledge || 0), React.createElement(\"p\", {\n      className: \"stat-key\",\n      style: {\n        fontSize: \"1em\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, \"knowledge\")), React.createElement(\"div\", {\n      className: \"column is-1-tablet is-4-mobile has-text-centered\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"stat-val\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }, this.props.reputation || 0), React.createElement(\"p\", {\n      className: \"stat-key\",\n      style: {\n        fontSize: \"1em\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }, \"reputation\"))));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    username: state.persistedReducer.username,\n    userId: state.persistedReducer.userID,\n    avatar: state.persistedReducer.avatar,\n    bio: state.persistedReducer.bio,\n    myPostsDetail: state.persistedReducer.myPostsDetail,\n    reputation: state.persistedReducer.reputation,\n    knowledge: state.persistedReducer.knowledge\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    updateAvatar: avatar => dispatch({\n      type: \"UPDATEAVATAR\",\n      avatar: avatar\n    }),\n    updateBio: bio => dispatch({\n      type: \"UPDATEBIO\",\n      bio: bio\n    })\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(HeadingSection);","map":{"version":3,"sources":["/Users/hantaoliu/Projects/Learning-Platform/techleak/client/src/components/userProfile/userProfileComponent/headingSection.jsx"],"names":["React","connect","axios","profile","getReputation","HeadingSection","Component","state","selectedFile","loading","editing","bio","props","fileHandler","e","setState","target","files","reader","FileReader","onload","dataURL","result","output","document","getElementById","src","width","readAsDataURL","handleEditPop","onChange","preventDefault","value","handleEdit","token","localStorage","getItem","headers","Authorization","withCredentials","patch","userId","then","res","updateBio","handleUpload","data","FormData","append","updateAvatar","avatar","process","env","REACT_APP_BACKEND_SERVER","catch","err","render","editInput","textAlign","filter","float","display","textOverflow","backgroundColor","color","borderColor","borderRadius","fontSize","overflow","username","margin","knowledge","reputation","mapStateToProps","persistedReducer","userID","myPostsDetail","mapDispatchToProps","dispatch","type"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { connect } from \"react-redux\";\nimport axios from \"../../../axios/axios-blogs\";\nimport profile from \"../../../assets/img/Portrait_Placeholder.png\";\nimport getReputation from \"../../../utils/getSumFromArray\";\n\nclass HeadingSection extends React.Component {\n  state = {\n    selectedFile: null,\n    loading: false,\n    editing: false,\n    bio: this.props.bio\n  };\n\n  fileHandler = e => {\n    this.setState({\n      selectedFile: e.target.files[0]\n    });\n    var reader = new FileReader();\n    reader.onload = function() {\n      var dataURL = reader.result;\n      var output = document.getElementById(\"profile\");\n      output.src = dataURL;\n      output.width = \"128px\";\n    };\n    reader.readAsDataURL(e.target.files[0]);\n  };\n\n  handleEditPop = () => {\n    this.setState({ editing: true });\n  };\n\n  onChange = e => {\n    e.preventDefault();\n    this.setState({ bio: e.target.value });\n  };\n\n  handleEdit = () => {\n    const token = localStorage.getItem(\"token\");\n    const headers = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Token ${token}`,\n        withCredentials: true\n      }\n    };\n    axios\n      .patch(\n        `/api/users/bio/${this.props.userId}`,\n        { bio: this.state.bio },\n        headers\n      )\n      .then(res => {\n        this.setState({ editing: false });\n      });\n    this.props.updateBio(this.state.bio);\n  };\n\n  handleUpload = () => {\n    if (this.state.selectedFile) {\n      const data = new FormData();\n      data.append(\"avatar\", this.state.selectedFile);\n      this.setState({ loading: true });\n      const token = localStorage.getItem(\"token\");\n      const headers = {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Token ${token}`,\n          withCredentials: true\n        }\n      };\n      axios\n        .patch(`/api/users/profile/${this.props.userId}`, data, headers)\n        .then(res => {\n          this.setState({ loading: false });\n          this.setState({ selectedFile: null });\n          this.props.updateAvatar(res.data.avatar);\n          axios.patch(\n            `${process.env.REACT_APP_BACKEND_SERVER}/api/posts/avatar/${\n              this.props.userId\n            }`,\n            { avatar: this.props.avatar },\n            headers\n          );\n        })\n        .catch(err => {\n          this.setState({ loading: false });\n          this.setState({ selectedFile: null });\n        });\n    }\n  };\n  render() {\n    const editInput = (\n      <div className=\"media-content\">\n        <div className=\"field\">\n          <p className=\"control\">\n            <textarea\n              className=\"textarea\"\n              value={this.state.bio}\n              onChange={this.onChange}\n              placeholder=\"Add a comment...\"\n            />\n          </p>\n        </div>\n        <div className=\"field\">\n          <p className=\"control\">\n            <button className=\"button\" onClick={this.handleEdit}>\n              Save\n            </button>\n          </p>\n        </div>\n      </div>\n    );\n\n    return (\n      <div className=\"section profile-heading\">\n        <div className=\"columns is-mobile is-multiline\">\n          <div\n            className=\"column is-2-tablet is-6-mobile name\"\n            style={{ textAlign: \"center\" }}\n          >\n            <span className=\"header-icon user-profile-image\">\n              <figure className=\"image is-square\">\n                <img\n                  id=\"profile\"\n                  src={this.props.avatar || profile}\n                  style={{ filter: `blur(${this.state.loading ? 2 : 0}px)` }}\n                  width=\"128px\"\n                  alt=\"profile\"\n                />\n              </figure>\n              <div className=\"file is-small\" style={{ float: \"left\" }}>\n                <label class=\"file-label\">\n                  <input\n                    class=\"file-input\"\n                    ode\n                    type=\"file\"\n                    name=\"resume\"\n                    onChange={this.fileHandler}\n                  />\n                  <span class=\"file-cta\">\n                    <span class=\"file-icon\">\n                      <i class=\"fas fa-upload\" />\n                    </span>\n                    <span\n                      class=\"file-label\"\n                      style={{\n                        display: \"inline-flex\",\n                        textOverflow: \"ellipsis\"\n                      }}\n                    >\n                      Select Image\n                    </span>\n                  </span>\n                </label>\n              </div>\n              <button\n                class={`button is-active is-small ${\n                  this.state.loading ? \"is-loading\" : \"\"\n                }`}\n                style={{\n                  display: \"inline-block\",\n                  backgroundColor: \"whitesmoke\",\n                  color: \"#4a4a4a\",\n                  borderColor: \"#dbdbdb\",\n                  borderRadius: \"4px\",\n                  fontSize: \"0.75em\",\n\n                  overflow: \"hidden\",\n                  textOverflow: \"ellipsis\"\n                }}\n                onClick={this.handleUpload}\n              >\n                Upload\n              </button>\n            </span>\n          </div>\n          <div className=\"column is-6-tablet is-6-mobile name\">\n            <p>\n              <span className=\"title is-bold\">{this.props.username}</span>\n              <br />\n              <button\n                className=\"button is-primary is-outlined\"\n                id=\"edit-preferences\"\n                style={{ margin: \"5px 0\" }}\n                onClick={this.handleEditPop}\n              >\n                Edit Biography\n              </button>\n            </p>\n            {this.state.editing ? editInput : <p>{this.props.bio}</p>}\n          </div>\n          <div className=\"column is-1-tablet is-2-mobile has-text-centered\" />\n          <div className=\"column is-1-tablet is-4-mobile has-text-centered\">\n            <p className=\"stat-val\">{this.props.knowledge || 0}</p>\n            <p className=\"stat-key\" style={{ fontSize: \"1em\" }}>\n              knowledge\n            </p>\n          </div>\n          <div className=\"column is-1-tablet is-4-mobile has-text-centered\">\n            <p className=\"stat-val\">{this.props.reputation || 0}</p>\n            <p className=\"stat-key\" style={{ fontSize: \"1em\" }}>\n              reputation\n            </p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    username: state.persistedReducer.username,\n    userId: state.persistedReducer.userID,\n    avatar: state.persistedReducer.avatar,\n    bio: state.persistedReducer.bio,\n    myPostsDetail: state.persistedReducer.myPostsDetail,\n    reputation: state.persistedReducer.reputation,\n    knowledge: state.persistedReducer.knowledge\n  };\n};\nconst mapDispatchToProps = dispatch => {\n  return {\n    updateAvatar: avatar => dispatch({ type: \"UPDATEAVATAR\", avatar: avatar }),\n    updateBio: bio => dispatch({ type: \"UPDATEBIO\", bio: bio })\n  };\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(HeadingSection);\n"]},"metadata":{},"sourceType":"module"}