{"ast":null,"code":"import _objectSpread from \"/Users/hantaoliu/Projects/Learning-Platform/techleak/client/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/hantaoliu/Projects/Learning-Platform/techleak/client/src/components/comment/comment.jsx\";\nimport React, { Component } from \"react\";\nimport Replies from \"./replies\";\nimport { connect } from \"react-redux\";\nimport axios from \"../../axios/axios-blogs\";\nimport elapsed from \"../../utils/getElapsed\";\n\nclass Comment extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      replyBox: false,\n      body: \"\"\n    };\n\n    this.openReply = () => {\n      this.setState({\n        replyBox: !this.state.replyBox\n      });\n    };\n\n    this.onChange = e => {\n      e.preventDefault();\n      this.setState({\n        body: e.target.value\n      });\n    };\n\n    this.handleDelete = () => {\n      axios.delete(\"api/posts/comments/\".concat(this.props.blogID, \"?commentId=\").concat(this.props.comment._id)).then(res => {\n        this.props.deleteComment(this.props.comment._id);\n      });\n    };\n\n    this.handleReply = () => {\n      const token = localStorage.getItem(\"token\");\n      const headers = {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Token \".concat(token),\n          withCredentials: true\n        }\n      };\n      axios.patch(\"/api/posts/comments/reply/\".concat(this.props.blogID, \"?commentId=\").concat(this.props.comment._id), {\n        reply: {\n          body: this.state.body,\n          username: this.props.username,\n          userID: this.props.userId,\n          post_date_timestamp: new Date().getTime()\n        }\n      }, headers).then(res => {\n        console.log(res);\n        this.props.addReply(_objectSpread({}, res.data, {\n          commentRef: this.props.comment._id\n        }));\n        this.setState({\n          body: \"\"\n        });\n      });\n    };\n\n    this.showReplyBox = () => {\n      if (this.state.replyBox) {\n        return React.createElement(\"div\", {\n          className: \"field has-addons\",\n          style: {\n            paddingTop: \"5px\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 63\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"control\",\n          style: {\n            width: \"100%\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 64\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          className: \"input is-rounded\",\n          type: \"text\",\n          placeholder: \"reply something...\",\n          onChange: this.onChange,\n          value: this.state.body,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 65\n          },\n          __self: this\n        })), React.createElement(\"div\", {\n          className: \"control\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 73\n          },\n          __self: this\n        }, React.createElement(\"button\", {\n          className: \"button is-info\",\n          onClick: this.handleReply,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 74\n          },\n          __self: this\n        }, React.createElement(\"i\", {\n          className: \"fas fa-reply\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 75\n          },\n          __self: this\n        }))));\n      }\n    };\n  }\n\n  render() {\n    const deleteButton = React.createElement(\"button\", {\n      className: \"button is-white\",\n      onClick: this.handleDelete,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fas fa-backspace\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }));\n    return React.createElement(\"article\", {\n      className: \"media\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }, React.createElement(\"figure\", {\n      className: \"media-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"image is-64x64\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: this.props.comment.avatar || \"https://bulma.io/images/placeholders/128x128.png\",\n      alt: \"placeholder\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"media-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"level\",\n      style: {\n        marginBottom: \"0px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, React.createElement(\"strong\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }, this.props.comment.username), this.props.comment.userId === this.props.userId ? deleteButton : null), this.props.comment.body, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }), React.createElement(\"small\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      class: \"button is-small is-light\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, \"Like \".concat(this.props.comment.like)), \" \\xB7\", \" \", React.createElement(\"button\", {\n      class: \"button is-small is-light\",\n      onClick: this.openReply,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }, \"Reply\"), \" \\xB7\", \" \", elapsed(new Date().getTime() - this.props.comment.post_date_timestamp), \" \", \"Ago\")), this.showReplyBox()), this.props.replies.length > 0 ? React.createElement(Replies, {\n      replies: this.props.replies.filter(reply => reply.commentRef === this.props.comment._id),\n      blogId: this.props.blogID,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }) : null));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    replies: state.persistedReducer.replies,\n    userId: state.persistedReducer.userID,\n    username: state.persistedReducer.username\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    addReply: reply => dispatch({\n      type: \"ADDREPLY\",\n      reply: reply\n    }),\n    deleteComment: id => dispatch({\n      type: \"DELETECOMMENT\",\n      id: id\n    })\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Comment);","map":{"version":3,"sources":["/Users/hantaoliu/Projects/Learning-Platform/techleak/client/src/components/comment/comment.jsx"],"names":["React","Component","Replies","connect","axios","elapsed","Comment","state","replyBox","body","openReply","setState","onChange","e","preventDefault","target","value","handleDelete","delete","props","blogID","comment","_id","then","res","deleteComment","handleReply","token","localStorage","getItem","headers","Authorization","withCredentials","patch","reply","username","userID","userId","post_date_timestamp","Date","getTime","console","log","addReply","data","commentRef","showReplyBox","paddingTop","width","render","deleteButton","avatar","marginBottom","like","replies","length","filter","mapStateToProps","persistedReducer","mapDispatchToProps","dispatch","type","id"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Replies from \"./replies\";\nimport { connect } from \"react-redux\";\nimport axios from \"../../axios/axios-blogs\";\nimport elapsed from \"../../utils/getElapsed\";\n\nclass Comment extends Component {\n  state = { replyBox: false, body: \"\" };\n  openReply = () => {\n    this.setState({ replyBox: !this.state.replyBox });\n  };\n  onChange = e => {\n    e.preventDefault();\n    this.setState({ body: e.target.value });\n  };\n  handleDelete = () => {\n    axios\n      .delete(\n        `api/posts/comments/${this.props.blogID}?commentId=${\n          this.props.comment._id\n        }`\n      )\n      .then(res => {\n        this.props.deleteComment(this.props.comment._id);\n      });\n  };\n  handleReply = () => {\n    const token = localStorage.getItem(\"token\");\n    const headers = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Token ${token}`,\n        withCredentials: true\n      }\n    };\n    axios\n      .patch(\n        `/api/posts/comments/reply/${this.props.blogID}?commentId=${\n          this.props.comment._id\n        }`,\n        {\n          reply: {\n            body: this.state.body,\n            username: this.props.username,\n            userID: this.props.userId,\n            post_date_timestamp: new Date().getTime()\n          }\n        },\n        headers\n      )\n      .then(res => {\n        console.log(res);\n        this.props.addReply({\n          ...res.data,\n          commentRef: this.props.comment._id\n        });\n        this.setState({ body: \"\" });\n      });\n  };\n  showReplyBox = () => {\n    if (this.state.replyBox) {\n      return (\n        <div className=\"field has-addons\" style={{ paddingTop:\"5px\" }}>\n          <div className=\"control\" style={{ width: \"100%\"}}>\n            <input\n              className=\"input is-rounded\"\n              type=\"text\"\n              placeholder=\"reply something...\"\n              onChange={this.onChange}\n              value={this.state.body}\n            />\n          </div>\n          <div className=\"control\">\n            <button className=\"button is-info\" onClick={this.handleReply}>\n              <i className=\"fas fa-reply\" />\n            </button>\n          </div>\n        </div>\n      );\n    }\n  };\n  render() {\n    const deleteButton = (\n      <button className=\"button is-white\" onClick={this.handleDelete}>\n        <i className=\"fas fa-backspace\" />\n      </button>\n    );\n    return (\n      <article className=\"media\">\n        <figure className=\"media-left\">\n          <p className=\"image is-64x64\">\n            <img\n              src={\n                this.props.comment.avatar ||\n                \"https://bulma.io/images/placeholders/128x128.png\"\n              }\n              alt=\"placeholder\"\n            />\n          </p>\n        </figure>\n        <div className=\"media-content\">\n          <div className=\"content\">\n            <div>\n              <div className=\"level\" style={{ marginBottom: \"0px\" }}>\n                <strong>{this.props.comment.username}</strong>\n                {this.props.comment.userId === this.props.userId\n                  ? deleteButton\n                  : null}\n              </div>\n              {this.props.comment.body}\n              <br />\n              <small>\n                <button class=\"button is-small is-light\">{`Like ${this.props.comment.like}`}</button> ·{\" \"}\n                <button class=\"button is-small is-light\" onClick={this.openReply}>Reply</button> ·{\" \"}\n                {elapsed(\n                  new Date().getTime() - this.props.comment.post_date_timestamp\n                )}{\" \"}\n                Ago\n              </small>\n            </div>\n            {this.showReplyBox()}\n          </div>\n          {this.props.replies.length > 0 ? (\n            <Replies\n              replies={this.props.replies.filter(\n                reply => reply.commentRef === this.props.comment._id\n              )}\n              blogId={this.props.blogID}\n            />\n          ) : null}\n        </div>\n      </article>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    replies: state.persistedReducer.replies,\n    userId: state.persistedReducer.userID,\n    username: state.persistedReducer.username\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    addReply: reply => dispatch({ type: \"ADDREPLY\", reply: reply }),\n    deleteComment: id => dispatch({ type: \"DELETECOMMENT\", id: id })\n  };\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Comment);\n"]},"metadata":{},"sourceType":"module"}