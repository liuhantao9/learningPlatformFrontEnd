{"ast":null,"code":"/*!\n * froala_editor v3.0.0-rc.1 (https://www.froala.com/wysiwyg-editor)\n * License https://froala.com/wysiwyg-editor/terms/\n * Copyright 2014-2019 Froala Labs\n */\n!function (e, a) {\n  \"object\" == typeof exports && \"undefined\" != typeof module ? a(require(\"froala-editor\")) : \"function\" == typeof define && define.amd ? define([\"froala-editor\"], a) : a(e.FroalaEditor);\n}(this, function (z) {\n  \"use strict\";\n\n  if (z = z && z.hasOwnProperty(\"default\") ? z[\"default\"] : z, Object.assign(z.DEFAULTS, {\n    imageManagerLoadURL: \"https://i.froala.com/load-files\",\n    imageManagerLoadMethod: \"get\",\n    imageManagerLoadParams: {},\n    imageManagerPreloader: null,\n    imageManagerDeleteURL: \"\",\n    imageManagerDeleteMethod: \"post\",\n    imageManagerDeleteParams: {},\n    imageManagerPageSize: 12,\n    imageManagerScrollOffset: 20,\n    imageManagerToggleTags: !0\n  }), z.PLUGINS.imageManager = function (s) {\n    var g,\n        l,\n        r,\n        n,\n        i,\n        d,\n        o,\n        m,\n        f,\n        c,\n        u,\n        p = s.$,\n        h = \"image_manager\",\n        e = 10,\n        v = 11,\n        M = 12,\n        b = 13,\n        w = 14,\n        C = 15,\n        t = 21,\n        L = 22,\n        D = {};\n\n    function y() {\n      var e = p(window).outerWidth();\n      return e < 768 ? 2 : e < 1200 ? 3 : 4;\n    }\n\n    function P() {\n      i.empty();\n\n      for (var e = 0; e < u; e++) {\n        i.append('<div class=\"fr-list-column\"></div>');\n      }\n    }\n\n    function I() {\n      if (f < o.length && (i.outerHeight() <= r.outerHeight() + s.opts.imageManagerScrollOffset || r.scrollTop() + s.opts.imageManagerScrollOffset > i.outerHeight() - r.outerHeight())) {\n        m++;\n\n        for (var e = s.opts.imageManagerPageSize * (m - 1); e < Math.min(o.length, s.opts.imageManagerPageSize * m); e++) {\n          a(o[e]);\n        }\n      }\n    }\n\n    function a(n) {\n      var i = new Image(),\n          o = p(document.createElement(\"div\")).attr(\"class\", \"fr-image-container fr-empty fr-image-\" + c++).attr(\"data-loading\", s.language.translate(\"Loading\") + \"..\").attr(\"data-deleting\", s.language.translate(\"Deleting\") + \"..\");\n      R(!1), i.onload = function () {\n        o.height(Math.floor(o.width() / i.width * i.height));\n        var t = p(document.createElement(\"img\"));\n        if (n.thumb) t.attr(\"src\", n.thumb);else {\n          if (O(w, n), !n.url) return O(C, n), !1;\n          t.attr(\"src\", n.url);\n        }\n        if (n.url && t.attr(\"data-url\", n.url), n.tag) if (l.find(\".fr-modal-more.fr-not-available\").removeClass(\"fr-not-available\"), l.find(\".fr-modal-tags\").show(), 0 <= n.tag.indexOf(\",\")) {\n          for (var e = n.tag.split(\",\"), a = 0; a < e.length; a++) {\n            e[a] = e[a].trim(), 0 === d.find('a[title=\"' + e[a] + '\"]').length && d.append('<a role=\"button\" title=\"' + e[a] + '\">' + e[a] + \"</a>\");\n          }\n\n          t.attr(\"data-tag\", e.join());\n        } else 0 === d.find('a[title=\"' + n.tag.trim() + '\"]').length && d.append('<a role=\"button\" title=\"' + n.tag.trim() + '\">' + n.tag.trim() + \"</a>\"), t.attr(\"data-tag\", n.tag.trim());\n\n        for (var r in n.name && t.attr(\"alt\", n.name), n) {\n          n.hasOwnProperty(r) && \"thumb\" !== r && \"url\" !== r && \"tag\" !== r && t.attr(\"data-\" + r, n[r]);\n        }\n\n        o.append(t).append(p(s.icon.create(\"imageManagerDelete\")).addClass(\"fr-delete-img\").attr(\"title\", s.language.translate(\"Delete\"))).append(p(s.icon.create(\"imageManagerInsert\")).addClass(\"fr-insert-img\").attr(\"title\", s.language.translate(\"Insert\"))), d.find(\".fr-selected-tag\").each(function (e, a) {\n          k(t, a.text) || o.hide();\n        }), t.on(\"load\", function () {\n          o.removeClass(\"fr-empty\"), o.height(\"auto\"), f++, E(T(parseInt(t.parent().attr(\"class\").match(/fr-image-(\\d+)/)[1], 10) + 1)), R(!1), f % s.opts.imageManagerPageSize == 0 && I();\n        }), s.events.trigger(\"imageManager.imageLoaded\", [t]);\n      }, i.onerror = function () {\n        f++, o.remove(), E(T(parseInt(o.attr(\"class\").match(/fr-image-(\\d+)/)[1], 10) + 1)), O(e, n), f % s.opts.imageManagerPageSize == 0 && I();\n      }, i.src = n.thumb || n.url, S().append(o);\n    }\n\n    function S() {\n      var r, n;\n      return i.find(\".fr-list-column\").each(function (e, a) {\n        var t = p(a);\n        0 === e ? (n = t.outerHeight(), r = t) : t.outerHeight() < n && (n = t.outerHeight(), r = t);\n      }), r;\n    }\n\n    function T(e) {\n      e === undefined && (e = 0);\n\n      for (var a = [], t = c - 1; e <= t; t--) {\n        var r = i.find(\".fr-image-\" + t);\n        r.length && (a.push(r), p(document.createElement(\"div\")).attr(\"id\", \"fr-image-hidden-container\").append(r), i.find(\".fr-image-\" + t).remove());\n      }\n\n      return a;\n    }\n\n    function E(e) {\n      for (var a = e.length - 1; 0 <= a; a--) {\n        S().append(e[a]);\n      }\n    }\n\n    function R(e) {\n      if (e === undefined && (e = !0), !g.isVisible()) return !0;\n      var a = y();\n\n      if (a !== u) {\n        u = a;\n        var t = T();\n        P(), E(t);\n      }\n\n      s.modals.resize(h), e && I();\n    }\n\n    function U(e) {\n      var a = {},\n          t = e.data();\n\n      for (var r in t) {\n        t.hasOwnProperty(r) && \"url\" !== r && \"tag\" !== r && (a[r] = t[r]);\n      }\n\n      return a;\n    }\n\n    function x(e) {\n      var a = p(e.currentTarget).siblings(\"img\"),\n          t = g.data(\"instance\") || s,\n          r = g.data(\"current-image\");\n      if (s.modals.hide(h), t.image.showProgressBar(), r) r.data(\"fr-old-src\", r.attr(\"src\")), r.trigger(\"click\");else {\n        t.events.focus(!0), t.selection.restore();\n        var n = t.position.getBoundingRect(),\n            i = n.left + n.width / 2 + p(s.doc).scrollLeft(),\n            o = n.top + n.height + p(s.doc).scrollTop();\n        t.popups.setContainer(\"image.insert\", s.$sc), t.popups.show(\"image.insert\", i, o);\n      }\n      t.image.insert(a.data(\"url\"), !1, U(a), r);\n    }\n\n    function H(e) {\n      var n = p(e.currentTarget).siblings(\"img\"),\n          a = s.language.translate(\"Are you sure? Image will be deleted.\");\n      confirm(a) && (s.opts.imageManagerDeleteURL ? !1 !== s.events.trigger(\"imageManager.beforeDeleteImage\", [n]) && (n.parent().addClass(\"fr-image-deleting\"), p(this).ajax({\n        method: s.opts.imageManagerDeleteMethod,\n        url: s.opts.imageManagerDeleteURL,\n        data: Object.assign(Object.assign({\n          src: n.attr(\"src\")\n        }, U(n)), s.opts.imageManagerDeleteParams),\n        crossDomain: s.opts.requestWithCORS,\n        withCredentials: s.opts.requestWithCredentials,\n        headers: s.opts.requestHeaders,\n        done: function done(e, a, t) {\n          s.events.trigger(\"imageManager.imageDeleted\", [e]);\n          var r = T(parseInt(n.parent().attr(\"class\").match(/fr-image-(\\d+)/)[1], 10) + 1);\n          n.parent().remove(), E(r), g.find(\"#fr-modal-tags > a\").each(function () {\n            0 === g.find('#fr-image-list [data-tag*=\"' + p(this).text() + '\"]').length && p(this).removeClass(\"fr-selected-tag\").hide();\n          }), _(), R(!0);\n        },\n        fail: function fail(e) {\n          O(t, e.response || e.responseText);\n        }\n      })) : O(L));\n    }\n\n    function O(e, a) {\n      10 <= e && e < 20 ? n.hide() : 20 <= e && e < 30 && p(\".fr-image-deleting\").removeClass(\"fr-image-deleting\"), s.events.trigger(\"imageManager.error\", [{\n        code: e,\n        message: D[e]\n      }, a]);\n    }\n\n    function q() {\n      var e = l.find(\".fr-modal-head-line\").outerHeight(),\n          a = d.outerHeight();\n      l.toggleClass(\"fr-show-tags\"), l.hasClass(\"fr-show-tags\") ? (l.css(\"height\", e + a), r.css(\"marginTop\", e + a), d.find(\"a\").css(\"opacity\", 1)) : (l.css(\"height\", e), r.css(\"marginTop\", e), d.find(\"a\").css(\"opacity\", 0));\n    }\n\n    function _() {\n      var e = d.find(\".fr-selected-tag\");\n      0 < e.length ? (i.find(\"img\").parents().show(), e.each(function (e, r) {\n        i.find(\"img\").each(function (e, a) {\n          var t = p(a);\n          k(t, r.text) || t.parent().hide();\n        });\n      })) : i.find(\"img\").parents().show(), E(T()), I();\n    }\n\n    function j(e) {\n      e.preventDefault();\n      var a = p(e.currentTarget);\n      a.toggleClass(\"fr-selected-tag\"), s.opts.imageManagerToggleTags && a.siblings(\"a\").removeClass(\"fr-selected-tag\"), _();\n    }\n\n    function k(e, a) {\n      for (var t = (e.attr(\"data-tag\") || \"\").split(\",\"), r = 0; r < t.length; r++) {\n        if (t[r] === a) return !0;\n      }\n\n      return !1;\n    }\n\n    return D[e] = \"Image cannot be loaded from the passed link.\", D[v] = \"Error during load images request.\", D[M] = \"Missing imageManagerLoadURL option.\", D[b] = \"Parsing load response failed.\", D[w] = \"Missing image thumb.\", D[C] = \"Missing image URL.\", D[t] = \"Error during delete image request.\", D[L] = \"Missing imageManagerDeleteURL option.\", {\n      require: [\"image\"],\n      _init: function _init() {\n        if (!s.$wp && \"IMG\" !== s.el.tagName) return !1;\n      },\n      show: function show() {\n        if (!g) {\n          var e,\n              a = '<button class=\"fr-command fr-btn fr-modal-more fr-not-available\" id=\"fr-modal-more-'.concat(s.sid, '\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"\"><path d=\"').concat(z.SVG.tags, '\"/></svg></button><h4 data-text=\"true\">').concat(s.language.translate(\"Manage Images\"), '</h4></div>\\n      <div class=\"fr-modal-tags\" id=\"fr-modal-tags\">');\n          e = s.opts.imageManagerPreloader ? '<img class=\"fr-preloader\" id=\"fr-preloader\" alt=\"' + s.language.translate(\"Loading\") + '..\" src=\"' + s.opts.imageManagerPreloader + '\" style=\"display: none;\">' : '<span class=\"fr-preloader\" id=\"fr-preloader\" style=\"display: none;\">' + s.language.translate(\"Loading\") + \"</span>\", e += '<div class=\"fr-image-list\" id=\"fr-image-list\"></div>';\n          var t = s.modals.create(h, a, e);\n          g = t.$modal, l = t.$head, r = t.$body;\n        }\n\n        g.data(\"current-image\", s.image.get()), s.modals.show(h), n || (n = g.find(\"#fr-preloader\"), i = g.find(\"#fr-image-list\"), d = g.find(\"#fr-modal-tags\"), u = y(), P(), l.css(\"height\", l.find(\".fr-modal-head-line\").outerHeight()), s.events.$on(p(s.o_win), \"resize\", function () {\n          R(!!o);\n        }), s.events.bindClick(i, \".fr-insert-img\", x), s.events.bindClick(i, \".fr-delete-img\", H), s.helpers.isMobile() && (s.events.bindClick(i, \"div.fr-image-container\", function (e) {\n          g.find(\".fr-mobile-selected\").removeClass(\"fr-mobile-selected\"), p(e.currentTarget).addClass(\"fr-mobile-selected\");\n        }), g.on(s._mousedown, function () {\n          g.find(\".fr-mobile-selected\").removeClass(\"fr-mobile-selected\");\n        })), g.on(s._mousedown + \" \" + s._mouseup, function (e) {\n          e.stopPropagation();\n        }), g.on(s._mousedown, \"*\", function () {\n          s.events.disableBlur();\n        }), r.on(\"scroll\", I), s.events.bindClick(g, \"button#fr-modal-more-\" + s.sid, q), s.events.bindClick(d, \"a\", j)), function () {\n          n.show(), i.find(\".fr-list-column\").empty(), s.opts.imageManagerLoadURL ? p(this).ajax({\n            url: s.opts.imageManagerLoadURL,\n            method: s.opts.imageManagerLoadMethod,\n            data: s.opts.imageManagerLoadParams,\n            dataType: \"json\",\n            crossDomain: s.opts.requestWithCORS,\n            withCredentials: s.opts.requestWithCredentials,\n            headers: s.opts.requestHeaders,\n            done: function done(e, a, t) {\n              s.events.trigger(\"imageManager.imagesLoaded\", [e]), function (e, a) {\n                try {\n                  i.find(\".fr-list-column\").empty(), c = f = m = 0, o = e, I();\n                } catch (t) {\n                  O(b, a);\n                }\n              }(e, t.response), n.hide();\n            },\n            fail: function fail(e) {\n              O(v, e.response || e.responseText);\n            }\n          }) : O(M);\n        }();\n      },\n      hide: function hide() {\n        s.modals.hide(h);\n      }\n    };\n  }, !z.PLUGINS.image) throw new Error(\"Image manager plugin requires image plugin.\");\n  z.DEFAULTS.imageInsertButtons.push(\"imageManager\"), z.RegisterCommand(\"imageManager\", {\n    title: \"Browse\",\n    undo: !1,\n    focus: !1,\n    modal: !0,\n    callback: function callback() {\n      this.imageManager.show();\n    },\n    plugin: \"imageManager\"\n  }), z.DefineIcon(\"imageManager\", {\n    NAME: \"folder\",\n    SVG_KEY: \"imageManager\"\n  }), z.DefineIcon(\"imageManagerInsert\", {\n    NAME: \"plus\",\n    SVG_KEY: \"add\"\n  }), z.DefineIcon(\"imageManagerDelete\", {\n    NAME: \"trash\",\n    SVG_KEY: \"remove\"\n  });\n});","map":null,"metadata":{},"sourceType":"script"}