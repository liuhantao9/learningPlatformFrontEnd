{"ast":null,"code":"var _jsxFileName = \"/Users/hantaoliu/Projects/Learning-Platform/techleak/client/src/components/Login.jsx\";\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nimport Modal from \"react-responsive-modal\";\nimport Spinner from \"./UI/Spinner/Spinner\";\nimport { connect } from \"react-redux\";\n\nclass Login extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      password: \"\",\n      email: \"\",\n      notMatched: false,\n      username: \"\",\n      loading: false\n    };\n\n    this.handleChange = (e, type) => {\n      if (type === \"email\" || type === \"password\") {\n        this.setState({\n          notMatched: false\n        });\n      }\n\n      this.setState({\n        [type]: e.target.value\n      });\n    };\n\n    this.handleSubmit = e => {\n      e.preventDefault();\n      this.setState({\n        loading: true\n      });\n      const _this$state = this.state,\n            email = _this$state.email,\n            password = _this$state.password;\n      const user = {\n        user: {\n          email: email,\n          password: password\n        }\n      };\n      axios.post(\"http://127.0.0.1:3000/api/users/login\", user).then(res => {\n        this.setState({\n          loading: false,\n          email: \"\",\n          password: \"\"\n        });\n        console.log(res);\n        this.props.handleLogIn(res.data.username, res.data.id, res.data.likedPosts); //close modal\n\n        this.props.onSwitchLoginModal(); //save tokens\n\n        localStorage.setItem(\"token\", res.data.token);\n      }).catch(err => {\n        this.setState({\n          notMatched: true,\n          loading: false\n        });\n      });\n    };\n\n    this.emailDuplicateError = () => {\n      if (this.state.emailError) {\n        return React.createElement(\"p\", {\n          className: \"help is-danger\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 55\n          },\n          __self: this\n        }, this.state.emailError);\n      }\n    };\n  }\n\n  render() {\n    const modalBg = {\n      modal: {\n        background: \"white \",\n        borderRadius: \"10%\",\n        maxHeight: \"43%\",\n        height: \"100%\",\n        maxWidth: \"30%\",\n        width: \"100%\"\n      }\n    };\n\n    const notMatchedError = () => {\n      if (this.state.notMatched) {\n        return React.createElement(\"p\", {\n          className: \"help is-danger\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 74\n          },\n          __self: this\n        }, \" Email and Password are not matched\");\n      } else {\n        return null;\n      }\n    };\n\n    let login = React.createElement(\"div\", {\n      style: {\n        padding: \"4%\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      onSubmit: this.handleSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"field\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      className: \"label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, \"Email\"), React.createElement(\"div\", {\n      className: \"control has-icons-left has-icons-right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      className: \"input is-primary\",\n      type: \"email\",\n      placeholder: \"Your Email\",\n      required: true,\n      onChange: e => this.handleChange(e, \"email\"),\n      value: this.state.email,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      className: \"icon is-small is-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fas fa-envelope\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    })), this.emailDuplicateError())), React.createElement(\"div\", {\n      className: \"field\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      className: \"label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, \"Password\"), React.createElement(\"div\", {\n      className: \"control has-icons-left has-icons-right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      className: \"input is-primary\",\n      type: \"password\",\n      placeholder: \"Your Password\",\n      minLength: \"8\",\n      maxLength: \"20\",\n      required: true,\n      onChange: e => this.handleChange(e, \"password\"),\n      value: this.state.password,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      className: \"icon is-small is-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fas fa-key\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    })))), notMatchedError(), React.createElement(\"div\", {\n      className: \"field is-grouped\",\n      style: {\n        justifyContent: \"center\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"control\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      type: \"submit\",\n      className: \"button is-primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, \"Login\")))));\n\n    if (this.state.loading) {\n      login = React.createElement(Spinner, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      });\n    }\n\n    return React.createElement(Modal, {\n      className: \"modal-lg\",\n      open: this.props.loginOpen,\n      onClose: this.props.onSwitchLoginModal,\n      center: true,\n      styles: modalBg,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, login);\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    loginOpen: state.loginOpen\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    handleLogIn: (username, userID, likedPosts) => dispatch({\n      type: \"LOGIN\",\n      username: username,\n      userID: userID,\n      likedPosts: likedPosts\n    }),\n    onSwitchLoginModal: () => dispatch({\n      type: \"LOGINMODAL\"\n    })\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Login);","map":{"version":3,"sources":["/Users/hantaoliu/Projects/Learning-Platform/techleak/client/src/components/Login.jsx"],"names":["React","Component","axios","Modal","Spinner","connect","Login","state","password","email","notMatched","username","loading","handleChange","e","type","setState","target","value","handleSubmit","preventDefault","user","post","then","res","console","log","props","handleLogIn","data","id","likedPosts","onSwitchLoginModal","localStorage","setItem","token","catch","err","emailDuplicateError","emailError","render","modalBg","modal","background","borderRadius","maxHeight","height","maxWidth","width","notMatchedError","login","padding","justifyContent","loginOpen","mapStateToProps","mapDispatchToProps","dispatch","userID"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport axios from \"axios\";\nimport Modal from \"react-responsive-modal\";\nimport Spinner from \"./UI/Spinner/Spinner\";\nimport { connect } from \"react-redux\";\nclass Login extends Component {\n  state = {\n    password: \"\",\n    email: \"\",\n    notMatched: false,\n    username: \"\",\n    loading: false\n  };\n\n  handleChange = (e, type) => {\n    if (type === \"email\" || type === \"password\") {\n      this.setState({ notMatched: false });\n    }\n    this.setState({ [type]: e.target.value });\n  };\n\n  handleSubmit = e => {\n    e.preventDefault();\n\n    this.setState({ loading: true });\n    const { email, password } = this.state;\n    const user = {\n      user: {\n        email: email,\n        password: password\n      }\n    };\n    axios\n      .post(\"http://127.0.0.1:3000/api/users/login\", user)\n      .then(res => {\n        this.setState({ loading: false, email: \"\", password: \"\" });\n        console.log(res);\n        this.props.handleLogIn(\n          res.data.username,\n          res.data.id,\n          res.data.likedPosts\n        );\n        //close modal\n        this.props.onSwitchLoginModal();\n        //save tokens\n        localStorage.setItem(\"token\", res.data.token);\n      })\n      .catch(err => {\n        this.setState({ notMatched: true, loading: false });\n      });\n  };\n\n  emailDuplicateError = () => {\n    if (this.state.emailError) {\n      return <p className=\"help is-danger\">{this.state.emailError}</p>;\n    }\n  };\n\n  render() {\n    const modalBg = {\n      modal: {\n        background: \"white \",\n        borderRadius: \"10%\",\n        maxHeight: \"43%\",\n        height: \"100%\",\n        maxWidth: \"30%\",\n        width: \"100%\"\n      }\n    };\n\n    const notMatchedError = () => {\n      if (this.state.notMatched) {\n        return (\n          <p className=\"help is-danger\"> Email and Password are not matched</p>\n        );\n      } else {\n        return null;\n      }\n    };\n\n    let login = (\n      <div style={{ padding: \"4%\" }}>\n        <form onSubmit={this.handleSubmit}>\n          <div className=\"field\">\n            <label className=\"label\">Email</label>\n            <div className=\"control has-icons-left has-icons-right\">\n              <input\n                className=\"input is-primary\"\n                type=\"email\"\n                placeholder=\"Your Email\"\n                required\n                onChange={e => this.handleChange(e, \"email\")}\n                value={this.state.email}\n              />\n\n              <span className=\"icon is-small is-left\">\n                <i className=\"fas fa-envelope\" />\n              </span>\n              {this.emailDuplicateError()}\n            </div>\n          </div>\n\n          <div className=\"field\">\n            <label className=\"label\">Password</label>\n            <div className=\"control has-icons-left has-icons-right\">\n              <input\n                className=\"input is-primary\"\n                type=\"password\"\n                placeholder=\"Your Password\"\n                minLength=\"8\"\n                maxLength=\"20\"\n                required\n                onChange={e => this.handleChange(e, \"password\")}\n                value={this.state.password}\n              />\n              <span className=\"icon is-small is-left\">\n                <i className=\"fas fa-key\" />\n              </span>\n            </div>\n          </div>\n          {notMatchedError()}\n          <div\n            className=\"field is-grouped\"\n            style={{ justifyContent: \"center\" }}\n          >\n            <div className=\"control\">\n              <button type=\"submit\" className=\"button is-primary\">\n                Login\n              </button>\n            </div>\n          </div>\n        </form>\n      </div>\n    );\n    if (this.state.loading) {\n      login = <Spinner />;\n    }\n    return (\n      <Modal\n        className=\"modal-lg\"\n        open={this.props.loginOpen}\n        onClose={this.props.onSwitchLoginModal}\n        center\n        styles={modalBg}\n      >\n        {login}\n      </Modal>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    loginOpen: state.loginOpen\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    handleLogIn: (username, userID, likedPosts) =>\n      dispatch({\n        type: \"LOGIN\",\n        username: username,\n        userID: userID,\n        likedPosts: likedPosts\n      }),\n    onSwitchLoginModal: () => dispatch({ type: \"LOGINMODAL\" })\n  };\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Login);\n"]},"metadata":{},"sourceType":"module"}