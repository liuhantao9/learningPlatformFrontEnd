{"ast":null,"code":"import _objectSpread from \"/Users/hantaoliu/Projects/Learning-Platform/techleak/client/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _objectWithoutProperties from \"/Users/hantaoliu/Projects/Learning-Platform/techleak/client/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _jsxFileName = \"/Users/hantaoliu/Projects/Learning-Platform/techleak/client/src/components/comment/comments.jsx\";\nimport React, { Component } from \"react\";\nimport Comment from \"./comment\";\nimport axios from \"../../axios/axios-blogs\";\nimport { connect } from \"react-redux\";\nimport getReputation from \"../../utils/getSumFromArray\";\n\nclass Comments extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      body: \"\"\n    };\n\n    this.onChange = e => {\n      e.preventDefault();\n      this.setState({\n        body: e.target.value\n      });\n    };\n\n    this.handlePost = () => {\n      const token = localStorage.getItem(\"token\");\n      const headers = {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Token \".concat(token),\n          withCredentials: true\n        }\n      };\n      axios.patch(\"/api/posts/comments/\".concat(this.props.blogID), {\n        comment: {\n          body: this.state.body,\n          username: this.props.username,\n          userId: this.props.userId,\n          post_date_timestamp: new Date().getTime(),\n          avatar: this.props.avatar || \"https://bulma.io/images/placeholders/128x128.png\",\n          knowledge: this.props.myPosts.length,\n          reputation: getReputation(this.props.myPosts, \"likes\")\n        }\n      }, headers).then(res => {\n        const _res$data = res.data,\n              replies = _res$data.replies,\n              comment = _objectWithoutProperties(_res$data, [\"replies\"]);\n\n        this.props.addComment(_objectSpread({}, comment));\n        this.setState({\n          body: \"\"\n        });\n      }).catch(err => {\n        console.log(\"error\");\n      });\n    };\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 53\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54\n      },\n      __self: this\n    }, \"Comments Section\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55\n      },\n      __self: this\n    }), this.props.comments.map((comment, index) => React.createElement(Comment, {\n      key: index,\n      comment: comment,\n      blogID: this.props.blogID,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58\n      },\n      __self: this\n    })), React.createElement(\"article\", {\n      className: \"media\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60\n      },\n      __self: this\n    }, React.createElement(\"figure\", {\n      className: \"media-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"image is-64x64\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: this.props.avatar || \"https://bulma.io/images/placeholders/128x128.png\",\n      alt: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"media-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"field\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"control\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74\n      },\n      __self: this\n    }, React.createElement(\"textarea\", {\n      className: \"textarea\",\n      value: this.state.body,\n      onChange: this.onChange,\n      placeholder: \"Add a comment...\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"field\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"control\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"button\",\n      onClick: this.handlePost,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, \"Post comment\"))))));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    comments: state.persistedReducer.comments,\n    username: state.persistedReducer.username,\n    userId: state.persistedReducer.userID,\n    avatar: state.persistedReducer.avatar,\n    myPosts: state.persistedReducer.myPostsDetail\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    addComment: comment => dispatch({\n      type: \"ADDCOMMENT\",\n      comment: comment\n    })\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Comments);","map":{"version":3,"sources":["/Users/hantaoliu/Projects/Learning-Platform/techleak/client/src/components/comment/comments.jsx"],"names":["React","Component","Comment","axios","connect","getReputation","Comments","state","body","onChange","e","preventDefault","setState","target","value","handlePost","token","localStorage","getItem","headers","Authorization","withCredentials","patch","props","blogID","comment","username","userId","post_date_timestamp","Date","getTime","avatar","knowledge","myPosts","length","reputation","then","res","data","replies","addComment","catch","err","console","log","render","comments","map","index","mapStateToProps","persistedReducer","userID","myPostsDetail","mapDispatchToProps","dispatch","type"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,OAAP,MAAoB,WAApB;AACA,OAAOC,KAAP,MAAkB,yBAAlB;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAOC,aAAP,MAA0B,6BAA1B;;AAEA,MAAMC,QAAN,SAAuBL,SAAvB,CAAiC;AAAA;AAAA;AAAA,SAC/BM,KAD+B,GACvB;AACNC,MAAAA,IAAI,EAAE;AADA,KADuB;;AAAA,SAI/BC,QAJ+B,GAIpBC,CAAC,IAAI;AACdA,MAAAA,CAAC,CAACC,cAAF;AACA,WAAKC,QAAL,CAAc;AAAEJ,QAAAA,IAAI,EAAEE,CAAC,CAACG,MAAF,CAASC;AAAjB,OAAd;AACD,KAP8B;;AAAA,SAQ/BC,UAR+B,GAQlB,MAAM;AACjB,YAAMC,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd;AACA,YAAMC,OAAO,GAAG;AACdA,QAAAA,OAAO,EAAE;AACP,0BAAgB,kBADT;AAEPC,UAAAA,aAAa,kBAAWJ,KAAX,CAFN;AAGPK,UAAAA,eAAe,EAAE;AAHV;AADK,OAAhB;AAOAlB,MAAAA,KAAK,CACFmB,KADH,+BAE2B,KAAKC,KAAL,CAAWC,MAFtC,GAGI;AACEC,QAAAA,OAAO,EAAE;AACPjB,UAAAA,IAAI,EAAE,KAAKD,KAAL,CAAWC,IADV;AAEPkB,UAAAA,QAAQ,EAAE,KAAKH,KAAL,CAAWG,QAFd;AAGPC,UAAAA,MAAM,EAAE,KAAKJ,KAAL,CAAWI,MAHZ;AAIPC,UAAAA,mBAAmB,EAAE,IAAIC,IAAJ,GAAWC,OAAX,EAJd;AAKPC,UAAAA,MAAM,EACJ,KAAKR,KAAL,CAAWQ,MAAX,IACA,kDAPK;AAQPC,UAAAA,SAAS,EAAE,KAAKT,KAAL,CAAWU,OAAX,CAAmBC,MARvB;AASPC,UAAAA,UAAU,EAAE9B,aAAa,CAAC,KAAKkB,KAAL,CAAWU,OAAZ,EAAqB,OAArB;AATlB;AADX,OAHJ,EAgBId,OAhBJ,EAkBGiB,IAlBH,CAkBQC,GAAG,IAAI;AAAA,0BACqBA,GAAG,CAACC,IADzB;AAAA,cACHC,OADG,aACHA,OADG;AAAA,cACSd,OADT;;AAEX,aAAKF,KAAL,CAAWiB,UAAX,mBAA2Bf,OAA3B;AACA,aAAKb,QAAL,CAAc;AAAEJ,UAAAA,IAAI,EAAE;AAAR,SAAd;AACD,OAtBH,EAuBGiC,KAvBH,CAuBSC,GAAG,IAAI;AACZC,QAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ;AACD,OAzBH;AA0BD,KA3C8B;AAAA;;AA4C/BC,EAAAA,MAAM,GAAG;AACP,WACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,EAIG,KAAKtB,KAAL,CAAWuB,QAAX,CAAoBC,GAApB,CAAwB,CAACtB,OAAD,EAAUuB,KAAV,KACvB,oBAAC,OAAD;AAAS,MAAA,GAAG,EAAEA,KAAd;AAAqB,MAAA,OAAO,EAAEvB,OAA9B;AAAuC,MAAA,MAAM,EAAE,KAAKF,KAAL,CAAWC,MAA1D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADD,CAJH,EAOE;AAAS,MAAA,SAAS,EAAC,OAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAQ,MAAA,SAAS,EAAC,YAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAG,MAAA,SAAS,EAAC,gBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AACE,MAAA,GAAG,EACD,KAAKD,KAAL,CAAWQ,MAAX,IACA,kDAHJ;AAKE,MAAA,GAAG,EAAC,EALN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADF,CADF,EAYE;AAAK,MAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAK,MAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAG,MAAA,SAAS,EAAC,SAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AACE,MAAA,SAAS,EAAC,UADZ;AAEE,MAAA,KAAK,EAAE,KAAKxB,KAAL,CAAWC,IAFpB;AAGE,MAAA,QAAQ,EAAE,KAAKC,QAHjB;AAIE,MAAA,WAAW,EAAC,kBAJd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADF,CADF,EAWE;AAAK,MAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAG,MAAA,SAAS,EAAC,SAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAQ,MAAA,SAAS,EAAC,QAAlB;AAA2B,MAAA,OAAO,EAAE,KAAKM,UAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,CADF,CAXF,CAZF,CAPF,CADF;AA0CD;;AAvF8B;;AA0FjC,MAAMkC,eAAe,GAAG1C,KAAK,IAAI;AAC/B,SAAO;AACLuC,IAAAA,QAAQ,EAAEvC,KAAK,CAAC2C,gBAAN,CAAuBJ,QAD5B;AAELpB,IAAAA,QAAQ,EAAEnB,KAAK,CAAC2C,gBAAN,CAAuBxB,QAF5B;AAGLC,IAAAA,MAAM,EAAEpB,KAAK,CAAC2C,gBAAN,CAAuBC,MAH1B;AAILpB,IAAAA,MAAM,EAAExB,KAAK,CAAC2C,gBAAN,CAAuBnB,MAJ1B;AAKLE,IAAAA,OAAO,EAAE1B,KAAK,CAAC2C,gBAAN,CAAuBE;AAL3B,GAAP;AAOD,CARD;;AAUA,MAAMC,kBAAkB,GAAGC,QAAQ,IAAI;AACrC,SAAO;AACLd,IAAAA,UAAU,EAAEf,OAAO,IAAI6B,QAAQ,CAAC;AAAEC,MAAAA,IAAI,EAAE,YAAR;AAAsB9B,MAAAA,OAAO,EAAEA;AAA/B,KAAD;AAD1B,GAAP;AAGD,CAJD;;AAMA,eAAerB,OAAO,CACpB6C,eADoB,EAEpBI,kBAFoB,CAAP,CAGb/C,QAHa,CAAf","sourcesContent":["import React, { Component } from \"react\";\nimport Comment from \"./comment\";\nimport axios from \"../../axios/axios-blogs\";\nimport { connect } from \"react-redux\";\nimport getReputation from \"../../utils/getSumFromArray\";\n\nclass Comments extends Component {\n  state = {\n    body: \"\"\n  };\n  onChange = e => {\n    e.preventDefault();\n    this.setState({ body: e.target.value });\n  };\n  handlePost = () => {\n    const token = localStorage.getItem(\"token\");\n    const headers = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Token ${token}`,\n        withCredentials: true\n      }\n    };\n    axios\n      .patch(\n        `/api/posts/comments/${this.props.blogID}`,\n        {\n          comment: {\n            body: this.state.body,\n            username: this.props.username,\n            userId: this.props.userId,\n            post_date_timestamp: new Date().getTime(),\n            avatar:\n              this.props.avatar ||\n              \"https://bulma.io/images/placeholders/128x128.png\",\n            knowledge: this.props.myPosts.length,\n            reputation: getReputation(this.props.myPosts, \"likes\")\n          }\n        },\n        headers\n      )\n      .then(res => {\n        const { replies, ...comment } = res.data;\n        this.props.addComment({ ...comment });\n        this.setState({ body: \"\" });\n      })\n      .catch(err => {\n        console.log(\"error\");\n      });\n  };\n  render() {\n    return (\n      <div>\n        <h1>Comments Section</h1>\n        <br />\n\n        {this.props.comments.map((comment, index) => (\n          <Comment key={index} comment={comment} blogID={this.props.blogID} />\n        ))}\n        <article className=\"media\">\n          <figure className=\"media-left\">\n            <p className=\"image is-64x64\">\n              <img\n                src={\n                  this.props.avatar ||\n                  \"https://bulma.io/images/placeholders/128x128.png\"\n                }\n                alt=\"\"\n              />\n            </p>\n          </figure>\n          <div className=\"media-content\">\n            <div className=\"field\">\n              <p className=\"control\">\n                <textarea\n                  className=\"textarea\"\n                  value={this.state.body}\n                  onChange={this.onChange}\n                  placeholder=\"Add a comment...\"\n                />\n              </p>\n            </div>\n            <div className=\"field\">\n              <p className=\"control\">\n                <button className=\"button\" onClick={this.handlePost}>\n                  Post comment\n                </button>\n              </p>\n            </div>\n          </div>\n        </article>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    comments: state.persistedReducer.comments,\n    username: state.persistedReducer.username,\n    userId: state.persistedReducer.userID,\n    avatar: state.persistedReducer.avatar,\n    myPosts: state.persistedReducer.myPostsDetail\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    addComment: comment => dispatch({ type: \"ADDCOMMENT\", comment: comment })\n  };\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Comments);\n"]},"metadata":{},"sourceType":"module"}