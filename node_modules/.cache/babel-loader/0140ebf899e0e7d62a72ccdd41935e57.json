{"ast":null,"code":"var _jsxFileName = \"/Users/hantaoliu/Projects/Learning-Platform/techleak/client/src/components/userProfile/userProfileComponent/simplifiedPost.jsx\";\nimport React from \"react\";\nimport Modal from \"react-responsive-modal\";\nimport axios from \"../../../axios/axios-blogs\";\nimport { connect } from \"react-redux\";\nimport { Link } from \"react-router-dom\";\nimport { confirmAlert } from \"react-custom-confirm-alert\";\nimport \"react-custom-confirm-alert/src/react-confirm-alert.css\";\n\nclass SimplifiedPost extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.deleteControl = () => {\n      const _this$props = this.props,\n            objectID = _this$props.objectID,\n            postType = _this$props.postType,\n            userID = _this$props.userID;\n\n      if (postType === \"MyPosts\") {\n        return React.createElement(\"button\", {\n          className: \"level-item button is-white\",\n          \"aria-label\": \"cancel\",\n          onClick: e => {\n            e.persist();\n            confirmAlert({\n              message: \"Your post will be deleted permanently, are you sure to do this?\",\n              buttons: [{\n                label: \"Yes\",\n                onClick: async () => {\n                  const token = localStorage.getItem(\"token\");\n                  const headers = {\n                    headers: {\n                      \"Content-Type\": \"application/json\",\n                      Authorization: \"Token \".concat(token)\n                    }\n                  };\n\n                  try {\n                    // delete the post in the \"Post\" pool backend\n                    let deletedPostData = axios.delete(\"\".concat(process.env.REACT_APP_BACKEND_SERVER, \"/api/posts/\").concat(objectID), headers); // delete the post in the author's \"myPost\" backend\n\n                    let deletedmyPostID = axios.delete(\"\".concat(process.env.REACT_APP_BACKEND_SERVER, \"/api/users/myPosts/\").concat(userID, \"?postID=\").concat(objectID), headers); // waiting for the above two promise to finish\n\n                    await Promise.all([deletedPostData, deletedmyPostID]); // handle the front end rendering after one \"myPost\" was deleted\n\n                    this.props.handleCancelClick(e, objectID, postType);\n                  } catch (e) {\n                    console.log(e);\n                  }\n                }\n              }, {\n                label: \"No\",\n                onClick: () => {\n                  console.log(objectID);\n                }\n              }]\n            });\n            e.preventDefault();\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 85\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"icon is-small\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 139\n          },\n          __self: this\n        }, React.createElement(\"i\", {\n          className: \"fas fa-times\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 140\n          },\n          __self: this\n        })));\n      } else if (postType === \"MyLikes\") {\n        return React.createElement(\"button\", {\n          className: \"level-item button is-white\",\n          \"aria-label\": \"cancel\",\n          onClick: e => {\n            // handle the front end rendering\n            this.props.handleCancelClick(e, objectID, postType); // handle the backend data stroge in data base\n\n            this.handleDelete(e, objectID);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"icon is-small\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 156\n          },\n          __self: this\n        }, React.createElement(\"i\", {\n          className: \"fas fa-times\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 157\n          },\n          __self: this\n        })));\n      }\n    };\n\n    this.state = {\n      openComment: false\n    };\n    this.handleComment = this.handleComment.bind(this);\n    this.handleStopPropagation = this.handleStopPropagation.bind(this);\n  }\n\n  spaceDividor() {\n    return React.createElement(\"div\", {\n      style: {\n        margin: \"5px\",\n        display: \"inline-block\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 20\n      },\n      __self: this\n    });\n  }\n\n  createTagGroup() {\n    const tags = this.props.tags;\n    return React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 26\n      },\n      __self: this\n    }, tags.map(tag => React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 28\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"button is-primary is-small\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 29\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 30\n      },\n      __self: this\n    }, tag)), this.spaceDividor())));\n  }\n\n  handleComment(e) {\n    this.setState({\n      openComment: !this.state.openComment\n    });\n    e.preventDefault();\n  }\n\n  handleStopPropagation(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    e.nativeEvent.stopImmediatePropagation();\n  } // delete like posts in the backend\n\n\n  handleDelete(e, objectID) {\n    const token = localStorage.getItem(\"token\");\n    const headers = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Token \".concat(token),\n        withCredentials: true\n      }\n    };\n    const liked = this.props.likedPosts.includes(objectID); // delete likedPost for users\n\n    const likePostPromise = axios.delete(\"/api/users/likes/\".concat(this.props.userID, \"?postID=\").concat(objectID), headers); //handling like# in Post route\n\n    const likeNumberPromise = axios.patch(\"/api/posts/likes/\".concat(objectID), {\n      liked: liked\n    }, headers);\n    Promise.all([likeNumberPromise, likePostPromise]).catch(err => {\n      this.props.handleLike(objectID, \"\", !liked);\n    });\n    this.props.handleLike(objectID, \"\", liked);\n  }\n\n  render() {\n    const _this$props2 = this.props,\n          title = _this$props2.title,\n          views = _this$props2.views,\n          comments = _this$props2.comments,\n          img = _this$props2.img,\n          objectID = _this$props2.objectID;\n    const openComment = this.state.openComment;\n    const simPostFormat = React.createElement(\"article\", {\n      className: \"media\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"media-left\",\n      onClick: e => this.handleStopPropagation(e),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, React.createElement(\"figure\", {\n      className: \"image is-64x64\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: img,\n      alt: \"Image\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"media-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, React.createElement(\"nav\", {\n      className: \"level is-mobile\",\n      style: {\n        float: \"right\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"level-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      className: \"level-item\",\n      \"aria-label\": \"comment\",\n      onClick: e => this.handleComment(e),\n      style: {\n        marginRight: \"0.25rem\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"icon is-small\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fas fa-comment\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }))), this.deleteControl())), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }, title), React.createElement(\"div\", {\n      style: {\n        float: \"left\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, this.createTagGroup()), React.createElement(\"p\", {\n      style: {\n        float: \"right\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }, React.createElement(\"small\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    }, views, \" Views\"), this.spaceDividor(), React.createElement(\"small\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, comments === \"-\" ? \"-\" : comments.length, \" Replies\")))))); // determine whether the simpost should be clickable based on the objectID\n\n    const simpPostClick = this.props.deleted === true ? React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    }, simPostFormat) : React.createElement(Link, {\n      to: \"/blog/\".concat(objectID),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }, simPostFormat);\n    return React.createElement(\"div\", {\n      className: \"box\",\n      style: {\n        marginBottom: \"0.5rem\",\n        padding: \"0.8rem\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218\n      },\n      __self: this\n    }, simpPostClick, React.createElement(Modal, {\n      open: openComment,\n      onClose: e => this.handleComment(e),\n      center: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223\n      },\n      __self: this\n    }, React.createElement(\"article\", {\n      className: \"media\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    }, React.createElement(\"figure\", {\n      className: \"media-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"image is-64x64\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: \"https://versions.bulma.io/0.7.0/images/placeholders/128x128.png\",\n      alt: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"media-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"field\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"control\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235\n      },\n      __self: this\n    }, React.createElement(\"textarea\", {\n      className: \"textarea\",\n      placeholder: \"Add a comment...\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236\n      },\n      __self: this\n    }))), React.createElement(\"nav\", {\n      className: \"level\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"level-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"level-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"button is-info button is-white\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245\n      },\n      __self: this\n    }, \"Submit\"))), React.createElement(\"div\", {\n      className: \"level-right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"level-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 251\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      className: \"checkbox\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 252\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"checkbox\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253\n      },\n      __self: this\n    }), \" Press enter to submit\"))))))));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    userID: state.persistedReducer.userID,\n    likedPosts: state.persistedReducer.likedPosts,\n    myPosts: state.persistedReducer.myPosts\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    handleLike: (id, rawPostData, liked) => dispatch({\n      type: \"HANDLELIKEPOSTS\",\n      id: id,\n      rawPostData: rawPostData,\n      liked: liked\n    })\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SimplifiedPost);","map":{"version":3,"sources":["/Users/hantaoliu/Projects/Learning-Platform/techleak/client/src/components/userProfile/userProfileComponent/simplifiedPost.jsx"],"names":["React","Modal","axios","connect","Link","confirmAlert","SimplifiedPost","Component","constructor","props","deleteControl","objectID","postType","userID","e","persist","message","buttons","label","onClick","token","localStorage","getItem","headers","Authorization","deletedPostData","delete","process","env","REACT_APP_BACKEND_SERVER","deletedmyPostID","Promise","all","handleCancelClick","console","log","preventDefault","handleDelete","state","openComment","handleComment","bind","handleStopPropagation","spaceDividor","margin","display","createTagGroup","tags","map","tag","setState","stopPropagation","nativeEvent","stopImmediatePropagation","withCredentials","liked","likedPosts","includes","likePostPromise","likeNumberPromise","patch","catch","err","handleLike","render","title","views","comments","img","simPostFormat","float","marginRight","length","simpPostClick","deleted","marginBottom","padding","mapStateToProps","persistedReducer","myPosts","mapDispatchToProps","dispatch","id","rawPostData","type"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport Modal from \"react-responsive-modal\";\nimport axios from \"../../../axios/axios-blogs\";\nimport { connect } from \"react-redux\";\nimport { Link } from \"react-router-dom\";\nimport { confirmAlert } from \"react-custom-confirm-alert\";\nimport \"react-custom-confirm-alert/src/react-confirm-alert.css\";\n\nclass SimplifiedPost extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      openComment: false\n    };\n    this.handleComment = this.handleComment.bind(this);\n    this.handleStopPropagation = this.handleStopPropagation.bind(this);\n  }\n\n  spaceDividor() {\n    return <div style={{ margin: \"5px\", display: \"inline-block\" }} />;\n  }\n\n  createTagGroup() {\n    const { tags } = this.props;\n    return (\n      <React.Fragment>\n        {tags.map(tag => (\n          <React.Fragment>\n            <button className=\"button is-primary is-small\">\n              <span>{tag}</span>\n            </button>\n            {this.spaceDividor()}\n          </React.Fragment>\n        ))}\n      </React.Fragment>\n    );\n  }\n\n  handleComment(e) {\n    this.setState({ openComment: !this.state.openComment });\n    e.preventDefault();\n  }\n\n  handleStopPropagation(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    e.nativeEvent.stopImmediatePropagation();\n  }\n\n  // delete like posts in the backend\n  handleDelete(e, objectID) {\n    const token = localStorage.getItem(\"token\");\n    const headers = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Token ${token}`,\n        withCredentials: true\n      }\n    };\n\n    const liked = this.props.likedPosts.includes(objectID);\n\n    // delete likedPost for users\n    const likePostPromise = axios.delete(\n      `/api/users/likes/${this.props.userID}?postID=${objectID}`,\n      headers\n    );\n\n    //handling like# in Post route\n    const likeNumberPromise = axios.patch(\n      `/api/posts/likes/${objectID}`,\n      { liked: liked },\n      headers\n    );\n    Promise.all([likeNumberPromise, likePostPromise]).catch(err => {\n      this.props.handleLike(objectID, \"\", !liked);\n    });\n    this.props.handleLike(objectID, \"\", liked);\n  }\n\n  deleteControl = () => {\n    const { objectID, postType, userID } = this.props;\n    if (postType === \"MyPosts\") {\n      return (\n        <button\n          className=\"level-item button is-white\"\n          aria-label=\"cancel\"\n          onClick={e => {\n            e.persist();\n            confirmAlert({\n              message:\n                \"Your post will be deleted permanently, are you sure to do this?\",\n              buttons: [\n                {\n                  label: \"Yes\",\n                  onClick: async () => {\n                    const token = localStorage.getItem(\"token\");\n                    const headers = {\n                      headers: {\n                        \"Content-Type\": \"application/json\",\n                        Authorization: `Token ${token}`\n                      }\n                    };\n                    try {\n                      // delete the post in the \"Post\" pool backend\n                      let deletedPostData = axios.delete(\n                        `${\n                          process.env.REACT_APP_BACKEND_SERVER\n                        }/api/posts/${objectID}`,\n                        headers\n                      );\n                      // delete the post in the author's \"myPost\" backend\n                      let deletedmyPostID = axios.delete(\n                        `${\n                          process.env.REACT_APP_BACKEND_SERVER\n                        }/api/users/myPosts/${userID}?postID=${objectID}`,\n                        headers\n                      );\n                      // waiting for the above two promise to finish\n                      await Promise.all([deletedPostData, deletedmyPostID]);\n                      // handle the front end rendering after one \"myPost\" was deleted\n                      this.props.handleCancelClick(e, objectID, postType);\n                    } catch (e) {\n                      console.log(e);\n                    }\n                  }\n                },\n                {\n                  label: \"No\",\n                  onClick: () => {\n                    console.log(objectID);\n                  }\n                }\n              ]\n            });\n            e.preventDefault();\n          }}\n        >\n          <span className=\"icon is-small\">\n            <i className=\"fas fa-times\" />\n          </span>\n        </button>\n      );\n    } else if (postType === \"MyLikes\") {\n      return (\n        <button\n          className=\"level-item button is-white\"\n          aria-label=\"cancel\"\n          onClick={e => {\n            // handle the front end rendering\n            this.props.handleCancelClick(e, objectID, postType);\n            // handle the backend data stroge in data base\n            this.handleDelete(e, objectID);\n          }}\n        >\n          <span className=\"icon is-small\">\n            <i className=\"fas fa-times\" />\n          </span>\n        </button>\n      );\n    }\n  };\n\n  render() {\n    const { title, views, comments, img, objectID } = this.props;\n    const { openComment } = this.state;\n    const simPostFormat = (\n      <article className=\"media\">\n        <div\n          className=\"media-left\"\n          onClick={e => this.handleStopPropagation(e)}\n        >\n          <figure className=\"image is-64x64\">\n            <img src={img} alt=\"Image\" />\n          </figure>\n        </div>\n        <div className=\"media-content\">\n          <div className=\"content\">\n            <nav className=\"level is-mobile\" style={{ float: \"right\" }}>\n              <div className=\"level-left\">\n                <a\n                  className=\"level-item\"\n                  aria-label=\"comment\"\n                  onClick={e => this.handleComment(e)}\n                  style={{ marginRight: \"0.25rem\" }}\n                >\n                  <span className=\"icon is-small\">\n                    <i className=\"fas fa-comment\" />\n                  </span>\n                </a>\n                {this.deleteControl()}\n              </div>\n            </nav>\n            <div>\n              <h3>{title}</h3>\n              <div style={{ float: \"left\" }}>{this.createTagGroup()}</div>\n              <p style={{ float: \"right\" }}>\n                <small>{views} Views</small>\n                {this.spaceDividor()}\n                <small>\n                  {comments === \"-\" ? \"-\" : comments.length} Replies\n                </small>\n              </p>\n            </div>\n          </div>\n        </div>\n      </article>\n    );\n\n    // determine whether the simpost should be clickable based on the objectID\n    const simpPostClick =\n      this.props.deleted === true ? (\n        <span>{simPostFormat}</span>\n      ) : (\n        <Link to={`/blog/${objectID}`}>{simPostFormat}</Link>\n      );\n    return (\n      <div\n        className=\"box\"\n        style={{ marginBottom: \"0.5rem\", padding: \"0.8rem\" }}\n      >\n        {simpPostClick}\n        <Modal open={openComment} onClose={e => this.handleComment(e)} center>\n          <article className=\"media\">\n            <figure className=\"media-left\">\n              <p className=\"image is-64x64\">\n                <img\n                  src=\"https://versions.bulma.io/0.7.0/images/placeholders/128x128.png\"\n                  alt=\"\"\n                />\n              </p>\n            </figure>\n            <div className=\"media-content\">\n              <div className=\"field\">\n                <p className=\"control\">\n                  <textarea\n                    className=\"textarea\"\n                    placeholder=\"Add a comment...\"\n                  />\n                </p>\n              </div>\n              <nav className=\"level\">\n                <div className=\"level-left\">\n                  <div className=\"level-item\">\n                    <button className=\"button is-info button is-white\">\n                      Submit\n                    </button>\n                  </div>\n                </div>\n                <div className=\"level-right\">\n                  <div className=\"level-item\">\n                    <label className=\"checkbox\">\n                      <input type=\"checkbox\" /> Press enter to submit\n                    </label>\n                  </div>\n                </div>\n              </nav>\n            </div>\n          </article>\n        </Modal>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    userID: state.persistedReducer.userID,\n    likedPosts: state.persistedReducer.likedPosts,\n    myPosts: state.persistedReducer.myPosts\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    handleLike: (id, rawPostData, liked) =>\n      dispatch({\n        type: \"HANDLELIKEPOSTS\",\n        id: id,\n        rawPostData: rawPostData,\n        liked: liked\n      })\n  };\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(SimplifiedPost);\n"]},"metadata":{},"sourceType":"module"}