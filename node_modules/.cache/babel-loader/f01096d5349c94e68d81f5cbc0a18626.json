{"ast":null,"code":"var _jsxFileName = \"/Users/hantaoliu/Projects/Learning-Platform/techleak/client/src/components/Blog.jsx\";\nimport React, { Component } from \"react\";\nimport Navbar from \"./navbar\";\nimport ReactHtmlParser from \"react-html-parser\";\nimport Comments from \"./comment/comments\";\nimport { connect } from \"react-redux\";\nimport axios from \"../axios/axios-blogs\";\nimport { withRouter } from \"react-router\";\nimport errorBoundary from \"./UI/ErrorHandler/ErrorHandler\";\nimport Share from \"./share/share\";\nimport Flexbox from 'flexbox-react';\n\nclass Blog extends Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = () => {\n      axios.get(\"/api/posts/\".concat(this.props.match.params.id), {\n        headers: \"\"\n      }).then(res => {\n        const date = new Date(res.data.post_date_timestamp);\n        this.setState({\n          comments: res.data.comments,\n          post_date: \"\".concat(date.getMonth() + 1, \"-\").concat(date.getDate(), \"-\").concat(date.getFullYear()),\n          username: res.data.username,\n          userID: res.data.userID,\n          content: res.data.content,\n          title: res.data.title,\n          pageID: this.props.match.params.id,\n          rawPostData: res.data,\n          tags: res.data.tags\n        });\n        this.props.getBlog(res.data);\n      }).catch(err => {\n        if (err.response.status === 400) {\n          // retrieve the post id that has been deleted by the original aurthor\n          // to update a user's likedposts in database and redux\n          const token = localStorage.getItem(\"token\");\n          const headers = {\n            headers: {\n              \"Content-Type\": \"application/json\",\n              Authorization: \"Token \".concat(token),\n              withCredentials: true\n            }\n          };\n          axios.delete(\"\".concat(process.env.REACT_APP_BACKEND_SERVER, \"/api/users/likes/\").concat(this.props.userID, \"?postID=\").concat(this.props.match.params.id), headers).then(res => {\n            this.props.handleLike(this.props.match.params.id, null, true);\n          }).catch(err => console.log(err));\n        }\n      });\n    };\n\n    this.handleLike = () => {\n      //disable the like for a moment\n      this.setState({\n        enableLike: false\n      });\n      const token = localStorage.getItem(\"token\");\n      const headers = {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Token \".concat(token),\n          withCredentials: true\n        }\n      };\n      const LIKED = this.props.likedPosts.includes(this.props.match.params.id); //handling likeposts in User route\n\n      const likePostPromise = LIKED ? axios.delete(\"/api/users/likes/\".concat(this.props.userID ? this.props.userID : \"dummy\", \"?postID=\").concat(this.props.match.params.id), headers) : axios.post(\"/api/users/likes/\".concat(this.props.userID ? this.props.userID : \"dummy\"), {\n        postID: this.props.match.params.id\n      }, headers); //handling like# in Post route\n\n      const likeNumberPromise = axios.patch(\"/api/posts/likes/\".concat(this.props.match.params.id), {\n        liked: LIKED\n      }, headers);\n      Promise.all([likePostPromise, likeNumberPromise]).catch(err => {\n        this.props.handleLike(this.props.match.params.id, this.state.rawPostData, !LIKED);\n      });\n      this.props.handleLike(this.props.match.params.id, this.state.rawPostData, LIKED);\n      new Promise(resolve => setTimeout(resolve, 1000)).then(() => {\n        this.setState({\n          enableLike: true\n        });\n      });\n    };\n\n    this.state = {\n      saved: false,\n      shared: false,\n      post_date: \"\",\n      comments: [],\n      username: \"\",\n      userID: \"\",\n      content: \"\",\n      title: \"\",\n      rawPostData: \"\",\n      tags: [],\n      enableLike: true\n    };\n    this.handleLike = this.handleLike.bind(this);\n  }\n\n  render() {\n    //handling disabled button\n    const btn = document.getElementById(\"likeBtn\");\n\n    if (btn) {\n      if (!this.state.enableLike) {\n        btn.setAttribute(\"disabled\", \"\");\n      } else {\n        btn.removeAttribute(\"disabled\");\n      }\n    }\n\n    const LIKED = this.props.likedPosts.includes(this.props.match.params.id);\n    console.log(this.state.tags);\n    let tagsDisplay = this.state.tags.map(tag => React.createElement(\"li\", {\n      key: tag,\n      style: styles.items,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }, React.createElement(Flexbox, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, tag)));\n    return React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, React.createElement(Navbar, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }), React.createElement(\"section\", {\n      className: \"hero is-info is-medium is-bold\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"hero-body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"container has-text-centered\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      className: \"title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, this.state.title)))), React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, React.createElement(\"section\", {\n      className: \"articles\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"column is-10 is-offset-1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"card article \",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"card-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"media\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"media-content has-text-centered\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"tags has-addons level-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"tag is-rounded is-info\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, \"DatePosted@\"), React.createElement(\"span\", {\n      className: \"tag is-rounded\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, this.state.post_date.slice(0, 10))))), React.createElement(\"div\", {\n      className: \"content article-body\",\n      style: {\n        marginBottom: \"10%\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, ReactHtmlParser(this.state.content)), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, tagsDisplay), React.createElement(\"hr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"level is-mobile\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"level-item has-text-centered button \",\n      onClick: this.props.onSwitchShareModal,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"icon is-small\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"far fa-share-square\",\n      \"aria-hidden\": \"true\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }))), React.createElement(\"button\", {\n      id: \"likeBtn\",\n      className: \"level-item has-text-centered button \".concat(LIKED ? \" is-success\" : \"\"),\n      \"aria-label\": \"like\",\n      onClick: this.state.enableLike ? this.handleLike : null,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"icon is-small\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"far fa-thumbs-up\",\n      \"aria-hidden\": \"true\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214\n      },\n      __self: this\n    })))), React.createElement(\"hr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218\n      },\n      __self: this\n    })), React.createElement(Comments, {\n      blogID: this.props.match.params.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220\n      },\n      __self: this\n    }))))), React.createElement(Share, {\n      pageID: this.state.pageID,\n      title: this.state.title,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    }));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    userID: state.persistedReducer.userID,\n    likedPosts: state.persistedReducer.likedPosts,\n    shareOpen: state.persistedReducer.shareOpen,\n    loggedIn: state.persistedReducer.loggedIn\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    getBlog: blog => dispatch({\n      type: \"GETBLOG\",\n      blog: blog\n    }),\n    onSwitchShareModal: () => dispatch({\n      type: \"SHAREMODAL\"\n    }),\n    handleLike: (id, rawPostData, liked) => dispatch({\n      type: \"HANDLELIKEPOSTS\",\n      id: id,\n      rawPostData: rawPostData,\n      liked: liked\n    })\n  };\n};\n\nexport default errorBoundary(withRouter(connect(mapStateToProps, mapDispatchToProps)(Blog)), axios);\nconst styles = {\n  items: {\n    display: \"inline-block\",\n    padding: \"5px\",\n    border: \"none\",\n    backgroundColor: \"#cfcece\",\n    fontFamily: \"Helvetica, sans-serif\",\n    borderRadius: \"5px\",\n    marginRight: \"5px\",\n    cursor: \"default\"\n  }\n};","map":{"version":3,"sources":["/Users/hantaoliu/Projects/Learning-Platform/techleak/client/src/components/Blog.jsx"],"names":["React","Component","Navbar","ReactHtmlParser","Comments","connect","axios","withRouter","errorBoundary","Share","Flexbox","Blog","constructor","props","componentDidMount","get","match","params","id","headers","then","res","date","Date","data","post_date_timestamp","setState","comments","post_date","getMonth","getDate","getFullYear","username","userID","content","title","pageID","rawPostData","tags","getBlog","catch","err","response","status","token","localStorage","getItem","Authorization","withCredentials","delete","process","env","REACT_APP_BACKEND_SERVER","handleLike","console","log","enableLike","LIKED","likedPosts","includes","likePostPromise","post","postID","likeNumberPromise","patch","liked","Promise","all","state","resolve","setTimeout","saved","shared","bind","render","btn","document","getElementById","setAttribute","removeAttribute","tagsDisplay","map","tag","styles","items","slice","marginBottom","onSwitchShareModal","mapStateToProps","persistedReducer","shareOpen","loggedIn","mapDispatchToProps","dispatch","blog","type","display","padding","border","backgroundColor","fontFamily","borderRadius","marginRight","cursor"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Navbar from \"./navbar\";\nimport ReactHtmlParser from \"react-html-parser\";\nimport Comments from \"./comment/comments\";\nimport { connect } from \"react-redux\";\nimport axios from \"../axios/axios-blogs\";\n\nimport { withRouter } from \"react-router\";\nimport errorBoundary from \"./UI/ErrorHandler/ErrorHandler\";\n\nimport Share from \"./share/share\";\nimport Flexbox from 'flexbox-react';\n\nclass Blog extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      saved: false,\n      shared: false,\n      post_date: \"\",\n      comments: [],\n      username: \"\",\n      userID: \"\",\n      content: \"\",\n      title: \"\",\n      rawPostData: \"\",\n      tags: [],\n      enableLike: true,\n    };\n\n    this.handleLike = this.handleLike.bind(this);\n  }\n\n  componentDidMount = () => {\n    axios\n      .get(`/api/posts/${this.props.match.params.id}`, { headers: \"\" })\n      .then(res => {\n        const date = new Date(res.data.post_date_timestamp);\n        this.setState({\n          comments: res.data.comments,\n          post_date: `${date.getMonth() +\n            1}-${date.getDate()}-${date.getFullYear()}`,\n          username: res.data.username,\n          userID: res.data.userID,\n          content: res.data.content,\n          title: res.data.title,\n          pageID: this.props.match.params.id,\n          rawPostData: res.data,\n          tags: res.data.tags\n        });\n        this.props.getBlog(res.data);\n      })\n      .catch(err => {\n        if (err.response.status === 400) {\n          // retrieve the post id that has been deleted by the original aurthor\n          // to update a user's likedposts in database and redux\n          const token = localStorage.getItem(\"token\");\n          const headers = {\n            headers: {\n              \"Content-Type\": \"application/json\",\n              Authorization: `Token ${token}`,\n              withCredentials: true\n            }\n          };\n          axios\n            .delete(\n              `${process.env.REACT_APP_BACKEND_SERVER}/api/users/likes/${\n              this.props.userID\n              }?postID=${this.props.match.params.id}`,\n              headers\n            )\n            .then(res => {\n              this.props.handleLike(\n                this.props.match.params.id,\n                null,\n                true\n              );\n            })\n            .catch(err => console.log(err));\n        }\n      });\n  };\n\n  handleLike = () => {\n    //disable the like for a moment\n    this.setState({ enableLike: false });\n    const token = localStorage.getItem(\"token\");\n    const headers = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Token ${token}`,\n        withCredentials: true\n      }\n    };\n    const LIKED = this.props.likedPosts.includes(this.props.match.params.id);\n\n    //handling likeposts in User route\n    const likePostPromise = LIKED\n      ? axios.delete(\n        `/api/users/likes/${\n        this.props.userID ? this.props.userID : \"dummy\"\n        }?postID=${this.props.match.params.id}`,\n        headers\n      )\n      : axios.post(\n        `/api/users/likes/${this.props.userID ? this.props.userID : \"dummy\"}`,\n        { postID: this.props.match.params.id },\n        headers\n      );\n    //handling like# in Post route\n    const likeNumberPromise = axios.patch(\n      `/api/posts/likes/${this.props.match.params.id}`,\n      { liked: LIKED },\n      headers\n    );\n\n    Promise.all([likePostPromise, likeNumberPromise]).catch(err => {\n      this.props.handleLike(\n        this.props.match.params.id,\n        this.state.rawPostData,\n        !LIKED\n      );\n    });\n    this.props.handleLike(\n      this.props.match.params.id,\n      this.state.rawPostData,\n      LIKED\n    );\n    new Promise(resolve => setTimeout(resolve, 1000)).then(() => {\n      this.setState({ enableLike: true });\n    });\n  };\n\n  render() {\n    //handling disabled button\n    const btn = document.getElementById(\"likeBtn\");\n    if (btn) {\n      if (!this.state.enableLike) {\n        btn.setAttribute(\"disabled\", \"\");\n      } else {\n        btn.removeAttribute(\"disabled\");\n      }\n    }\n    const LIKED = this.props.likedPosts.includes(this.props.match.params.id);\n    console.log(this.state.tags)\n\n    let tagsDisplay = this.state.tags.map(tag => (\n      <li key={tag} style={styles.items}>\n        <Flexbox>\n          {tag}\n        </Flexbox>\n      </li>\n    ));\n    return (\n      <React.Fragment>\n        <Navbar />\n\n        <section className=\"hero is-info is-medium is-bold\">\n          <div className=\"hero-body\">\n            <div className=\"container has-text-centered\">\n              <h1 className=\"title\">{this.state.title}</h1>\n            </div>\n          </div>\n        </section>\n\n        <div className=\"container\">\n          <section className=\"articles\">\n            <div className=\"column is-10 is-offset-1\">\n              <div className=\"card article \">\n                <div className=\"card-content\">\n                  <div className=\"media\">\n                    <div className=\"media-content has-text-centered\">\n                      <div className=\"tags has-addons level-item\">\n                        <span className=\"tag is-rounded is-info\">\n                          DatePosted@\n                        </span>\n                        <span className=\"tag is-rounded\">\n                          {this.state.post_date.slice(0, 10)}\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                  <div\n                    className=\"content article-body\"\n                    style={{ marginBottom: \"10%\" }}\n                  >\n                    {ReactHtmlParser(this.state.content)}\n                  </div>\n                  <div>\n                    {tagsDisplay}\n                  </div>\n                  <hr />\n\n                  <div className=\"level is-mobile\">\n                    <button\n                      className=\"level-item has-text-centered button \"\n                      onClick={this.props.onSwitchShareModal}\n                    >\n                      <span className=\"icon is-small\">\n                        <i className=\"far fa-share-square\" aria-hidden=\"true\" />\n                      </span>\n                    </button>\n\n                    <button\n                      id=\"likeBtn\"\n                      className={`level-item has-text-centered button ${\n                        LIKED ? \" is-success\" : \"\"\n                        }`}\n                      aria-label=\"like\"\n                      onClick={this.state.enableLike ? this.handleLike : null}\n                    >\n                      <span className=\"icon is-small\">\n                        <i className=\"far fa-thumbs-up\" aria-hidden=\"true\" />\n                      </span>\n                    </button>\n                  </div>\n                  <hr />\n                </div>\n                <Comments blogID={this.props.match.params.id} />\n              </div>\n            </div>\n          </section>\n        </div>\n        <Share pageID={this.state.pageID} title={this.state.title} />\n      </React.Fragment>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    userID: state.persistedReducer.userID,\n    likedPosts: state.persistedReducer.likedPosts,\n    shareOpen: state.persistedReducer.shareOpen,\n    loggedIn: state.persistedReducer.loggedIn\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    getBlog: blog => dispatch({ type: \"GETBLOG\", blog: blog }),\n    onSwitchShareModal: () => dispatch({ type: \"SHAREMODAL\" }),\n    handleLike: (id, rawPostData, liked) =>\n      dispatch({\n        type: \"HANDLELIKEPOSTS\",\n        id: id,\n        rawPostData: rawPostData,\n        liked: liked\n      })\n  };\n};\n\nexport default errorBoundary(\n  withRouter(\n    connect(\n      mapStateToProps,\n      mapDispatchToProps\n    )(Blog)\n  ),\n  axios\n);\n\nconst styles = {\n  items: {\n    display: \"inline-block\",\n    padding: \"5px\",\n    border: \"none\",\n    backgroundColor: \"#cfcece\",\n    fontFamily: \"Helvetica, sans-serif\",\n    borderRadius: \"5px\",\n    marginRight: \"5px\",\n    cursor: \"default\"\n  }\n}\n"]},"metadata":{},"sourceType":"module"}