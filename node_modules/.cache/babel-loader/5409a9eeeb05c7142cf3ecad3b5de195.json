{"ast":null,"code":"var _jsxFileName = \"/Users/hantaoliu/Projects/Learning-Platform/techleak/client/src/components/userProfile/userProfileComponent/simplifedPosts.jsx\";\nimport React from \"react\";\nimport axios from \"axios\";\nimport { connect } from \"react-redux\";\nimport SimplifiedPost from \"./simplifiedPost\";\nimport { stat } from \"fs\";\n\nvar faker = require(\"faker\");\n\nclass SimplifiedPosts extends React.Component {\n  constructor(props) {\n    super(props);\n    this.retrievePosts(this.props.PostType);\n    this.state = {\n      simpPosts: []\n    };\n    this.handleCancelClick = this.handleCancelClick.bind(this);\n  }\n\n  handleAdjustLikedPost(id, status) {\n    // retrieve the post id that has been deleted by the original aurthor\n    // to update a user's likedposts in database and redux\n    const token = localStorage.getItem(\"token\");\n    const headers = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Token \".concat(token),\n        withCredentials: true\n      }\n    };\n\n    if (status == 400) {\n      axios.delete(\"\".concat(process.env.REACT_APP_BACKEND_SERVER, \"/api/users/likes/\").concat(this.props.userID, \"?postID=\").concat(id), headers).then(res => {\n        this.props.handleUpdatedLikedPosts(res.data.likedPosts);\n      }).catch(err => console.log(err));\n    }\n  }\n\n  retrievePosts(PostType) {\n    const tempPosts = [];\n    var processPosts = [];\n\n    if (PostType === \"MyLikes\") {\n      processPosts = this.props.likedPosts;\n    } else if (PostType === \"MyPosts\") {\n      processPosts = this.props.myPosts;\n    }\n\n    for (var i = 0; i < processPosts.length; i++) {\n      axios.get(\"\".concat(process.env.REACT_APP_BACKEND_SERVER, \"/api/posts/\").concat(processPosts[i])).then(res => {\n        var temp = {\n          title: \"\",\n          views: \"\",\n          answers: \"\",\n          tagNames: \"\",\n          img: \"\",\n          objectID: \"\"\n        };\n        temp.title = res.data.title;\n        temp.views = faker.random.number();\n        temp.answers = res.data.comments.length;\n        temp.tagNames = res.data.tags;\n        temp.img = faker.image.avatar();\n        temp.objectID = res.data._id;\n        tempPosts.push(temp);\n        this.setState({\n          simpPosts: tempPosts\n        });\n      }).catch(err => {\n        var url = err.response.config.url;\n        var id = url.substring(url.lastIndexOf('/') + 1);\n        var status = err.response.status;\n        this.handleAdjustLikedPost(id, status);\n      });\n    }\n  } // randomPosts() {\n  //     var simpPosts = [];\n  //     for (var i = 0; i < 10; i++) {\n  //         var temp = { title: \"\", views: \"\", answers: \"\", tagNames: \"\", img: \"\" };\n  //         temp.title = faker.lorem.lines();\n  //         temp.views = faker.random.number();\n  //         temp.answers = faker.random.number();\n  //         temp.tagNames = [faker.random.word(), faker.random.word(), faker.random.word()];\n  //         temp.img = faker.image.avatar();\n  //         simpPosts.push(temp);\n  //     }\n  //     return simpPosts;\n  // }\n\n\n  handleCancelClick(e, title) {\n    e.preventDefault();\n    const newSimpPosts = this.state.simpPosts.filter(simPost => {\n      return simPost.title !== title;\n    });\n    this.setState({\n      simpPosts: [...newSimpPosts]\n    });\n  }\n\n  render() {\n    const simpPosts = this.state.simpPosts;\n    return React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, simpPosts.map(simPost => {\n      return React.createElement(SimplifiedPost, {\n        title: simPost.title,\n        views: simPost.views,\n        answers: simPost.answers,\n        tagNames: simPost.tagNames,\n        img: simPost.img,\n        objectID: simPost.objectID,\n        handleCancelClick: this.handleCancelClick,\n        PostType: this.props.PostType,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      });\n    }));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    userID: state.persistedReducer.userID,\n    loggedIn: state.persistedReducer.loggedIn,\n    likedPosts: state.persistedReducer.likedPosts,\n    myPosts: state.persistedReducer.myPosts\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    handleUpdatedLikedPosts: updatedLikedPosts => dispatch({\n      type: \"USERLIKEDPOSTSUPDATED\",\n      likedPosts: updatedLikedPosts\n    })\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SimplifiedPosts);","map":{"version":3,"sources":["/Users/hantaoliu/Projects/Learning-Platform/techleak/client/src/components/userProfile/userProfileComponent/simplifedPosts.jsx"],"names":["React","axios","connect","SimplifiedPost","stat","faker","require","SimplifiedPosts","Component","constructor","props","retrievePosts","PostType","state","simpPosts","handleCancelClick","bind","handleAdjustLikedPost","id","status","token","localStorage","getItem","headers","Authorization","withCredentials","delete","process","env","REACT_APP_BACKEND_SERVER","userID","then","res","handleUpdatedLikedPosts","data","likedPosts","catch","err","console","log","tempPosts","processPosts","myPosts","i","length","get","temp","title","views","answers","tagNames","img","objectID","random","number","comments","tags","image","avatar","_id","push","setState","url","response","config","substring","lastIndexOf","e","preventDefault","newSimpPosts","filter","simPost","render","map","mapStateToProps","persistedReducer","loggedIn","mapDispatchToProps","dispatch","updatedLikedPosts","type"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport axios from \"axios\";\nimport { connect } from \"react-redux\";\nimport SimplifiedPost from \"./simplifiedPost\";\nimport { stat } from \"fs\";\n\nvar faker = require(\"faker\");\n\nclass SimplifiedPosts extends React.Component {\n  constructor(props) {\n    super(props);\n    this.retrievePosts(this.props.PostType);\n    this.state = {\n      simpPosts: []\n    };\n    this.handleCancelClick = this.handleCancelClick.bind(this);\n  }\n\n  handleAdjustLikedPost(id, status) {\n    // retrieve the post id that has been deleted by the original aurthor\n    // to update a user's likedposts in database and redux\n    const token = localStorage.getItem(\"token\");\n    const headers = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Token ${token}`,\n        withCredentials: true\n      }\n    };\n    if (status == 400) {\n      axios\n        .delete(\n          `${process.env.REACT_APP_BACKEND_SERVER}/api/users/likes/${\n          this.props.userID\n          }?postID=${id}`,\n          headers\n        )\n        .then(res => {\n          this.props.handleUpdatedLikedPosts(res.data.likedPosts)\n        }\n        )\n        .catch(err =>\n          console.log(err)\n        )\n    }\n  }\n\n  retrievePosts(PostType) {\n    const tempPosts = [];\n    var processPosts = [];\n    if (PostType === \"MyLikes\") {\n      processPosts = this.props.likedPosts;\n    } else if (PostType === \"MyPosts\") {\n      processPosts = this.props.myPosts;\n    }\n    for (var i = 0; i < processPosts.length; i++) {\n      axios\n        .get(\n          `${process.env.REACT_APP_BACKEND_SERVER}/api/posts/${processPosts[i]}`\n        )\n        .then(res => {\n          var temp = {\n            title: \"\",\n            views: \"\",\n            answers: \"\",\n            tagNames: \"\",\n            img: \"\",\n            objectID: \"\"\n          };\n          temp.title = res.data.title;\n          temp.views = faker.random.number();\n          temp.answers = res.data.comments.length;\n          temp.tagNames = res.data.tags;\n          temp.img = faker.image.avatar();\n          temp.objectID = res.data._id;\n          tempPosts.push(temp);\n          this.setState({ simpPosts: tempPosts });\n        })\n        .catch(err => {\n          var url = err.response.config.url;\n          var id = url.substring(url.lastIndexOf('/') + 1);\n          var status = err.response.status;\n          this.handleAdjustLikedPost(id, status);\n        });\n    }\n  }\n\n  // randomPosts() {\n  //     var simpPosts = [];\n  //     for (var i = 0; i < 10; i++) {\n  //         var temp = { title: \"\", views: \"\", answers: \"\", tagNames: \"\", img: \"\" };\n  //         temp.title = faker.lorem.lines();\n  //         temp.views = faker.random.number();\n  //         temp.answers = faker.random.number();\n  //         temp.tagNames = [faker.random.word(), faker.random.word(), faker.random.word()];\n  //         temp.img = faker.image.avatar();\n  //         simpPosts.push(temp);\n  //     }\n  //     return simpPosts;\n  // }\n\n  handleCancelClick(e, title) {\n    e.preventDefault();\n    const newSimpPosts = this.state.simpPosts.filter(simPost => {\n      return simPost.title !== title;\n    });\n\n    this.setState({\n      simpPosts: [...newSimpPosts]\n    });\n  }\n\n  render() {\n    const { simpPosts } = this.state;\n    return (\n      <React.Fragment>\n        {simpPosts.map(simPost => {\n          return (\n            <SimplifiedPost\n              title={simPost.title}\n              views={simPost.views}\n              answers={simPost.answers}\n              tagNames={simPost.tagNames}\n              img={simPost.img}\n              objectID={simPost.objectID}\n              handleCancelClick={this.handleCancelClick}\n              PostType={this.props.PostType}\n            />\n          );\n        })}\n      </React.Fragment>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    userID: state.persistedReducer.userID,\n    loggedIn: state.persistedReducer.loggedIn,\n    likedPosts: state.persistedReducer.likedPosts,\n    myPosts: state.persistedReducer.myPosts\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    handleUpdatedLikedPosts: (updatedLikedPosts) =>\n      dispatch({\n        type: \"USERLIKEDPOSTSUPDATED\",\n        likedPosts: updatedLikedPosts\n      })\n  };\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(SimplifiedPosts);\n"]},"metadata":{},"sourceType":"module"}