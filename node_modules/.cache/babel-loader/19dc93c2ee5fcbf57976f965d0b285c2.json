{"ast":null,"code":"var _jsxFileName = \"/Users/hantaoliu/Projects/Learning-Platform/techleak/client/src/components/userProfile/userProfileComponent/simplifiedPost.jsx\";\nimport React from \"react\";\nimport Modal from \"react-responsive-modal\";\nimport axios from \"axios\";\nimport { connect } from \"react-redux\";\nimport { Link } from \"react-router-dom\";\nimport { confirmAlert } from \"react-custom-confirm-alert\";\nimport 'react-custom-confirm-alert/src/react-confirm-alert.css';\n\nclass SimplifiedPost extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.deleteControl = () => {\n      const _this$props = this.props,\n            title = _this$props.title,\n            objectID = _this$props.objectID,\n            PostType = _this$props.PostType,\n            userID = _this$props.userID,\n            myPosts = _this$props.myPosts;\n\n      if (PostType === \"MyPosts\") {\n        return React.createElement(\"a\", {\n          className: \"level-item\",\n          \"aria-label\": \"cancel\",\n          onClick: e => {\n            e.persist();\n            confirmAlert({\n              message: 'Your post will be deleted permanently, are you sure to do this?',\n              buttons: [{\n                label: 'Yes',\n                onClick: async () => {\n                  const token = localStorage.getItem(\"token\");\n                  const headers = {\n                    headers: {\n                      \"Content-Type\": \"application/json\",\n                      Authorization: \"Token \".concat(token)\n                    }\n                  };\n\n                  try {\n                    // delete the post in the \"Post\" pool backend\n                    let deletedPostData = axios.delete(\"\".concat(process.env.REACT_APP_BACKEND_SERVER, \"/api/posts/\").concat(objectID), headers); // delete the post in the author's \"myPost\" backend\n\n                    let deletedmyPostID = axios.delete(\"\".concat(process.env.REACT_APP_BACKEND_SERVER, \"/api/users/myPosts/\").concat(userID, \"?postID=\").concat(objectID), headers); // waiting for the above two promise to finish\n\n                    await Promise.all([deletedPostData, deletedmyPostID]); // handle the front end rendering after one \"myPost\" was deleted\n\n                    this.props.handleCancelClick(e, objectID, PostType);\n                  } catch (e) {\n                    console.log(e);\n                  }\n                }\n              }, {\n                label: 'No',\n                onClick: () => {\n                  console.log(objectID);\n                }\n              }]\n            });\n            e.preventDefault();\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 86\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"icon is-small\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 137\n          },\n          __self: this\n        }, React.createElement(\"i\", {\n          className: \"fas fa-times\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 138\n          },\n          __self: this\n        })));\n      } else if (PostType === \"MyLikes\") {\n        return React.createElement(\"a\", {\n          className: \"level-item\",\n          \"aria-label\": \"cancel\",\n          onClick: e => {\n            // handle the front end rendering\n            this.props.handleCancelClick(e, objectID, PostType); // handle the backend data stroge in data base\n\n            this.handleDelete(e, objectID);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 144\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"icon is-small\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 154\n          },\n          __self: this\n        }, React.createElement(\"i\", {\n          className: \"fas fa-times\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 155\n          },\n          __self: this\n        })));\n      }\n    };\n\n    this.state = {\n      openComment: false\n    };\n    this.handleComment = this.handleComment.bind(this);\n    this.handleStopPropagation = this.handleStopPropagation.bind(this);\n  }\n\n  spaceDividor() {\n    return React.createElement(\"div\", {\n      style: {\n        margin: \"5px\",\n        display: \"inline-block\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 20\n      },\n      __self: this\n    });\n  }\n\n  createTagGroup() {\n    const tags = this.props.tags;\n    return React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 26\n      },\n      __self: this\n    }, tags.map(tag => React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 28\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      className: \"button is-primary is-small\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 29\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 30\n      },\n      __self: this\n    }, tag)), this.spaceDividor())));\n  }\n\n  handleComment(e) {\n    this.setState({\n      openComment: !this.state.openComment\n    });\n    e.preventDefault();\n  }\n\n  handleStopPropagation(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    e.nativeEvent.stopImmediatePropagation();\n  } // delete like posts in the backend\n\n\n  handleDelete(e, objectID) {\n    const token = localStorage.getItem(\"token\");\n    const headers = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Token \".concat(token),\n        withCredentials: true\n      }\n    };\n    const liked = this.props.likedPosts.includes(objectID);\n    axios.delete(\"\".concat(process.env.REACT_APP_BACKEND_SERVER, \"/api/users/likes/\").concat(this.props.userID, \"?postID=\").concat(objectID), headers);\n    axios.patch(\"\".concat(process.env.REACT_APP_BACKEND_SERVER, \"/api/posts/likes/\").concat(objectID), {\n      liked: liked\n    }, headers).then(res => {\n      this.props.handleLike(objectID, liked);\n    }).catch(err => err);\n  }\n\n  render() {\n    const _this$props2 = this.props,\n          title = _this$props2.title,\n          views = _this$props2.views,\n          comments = _this$props2.comments,\n          img = _this$props2.img,\n          objectID = _this$props2.objectID;\n    const openComment = this.state.openComment;\n    return React.createElement(\"div\", {\n      className: \"box\",\n      style: {\n        marginBottom: \"0.5rem\",\n        padding: \"0.8rem\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/blog/\".concat(objectID),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, React.createElement(\"article\", {\n      className: \"media\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"media-left\",\n      onClick: e => this.handleStopPropagation(e),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, React.createElement(\"figure\", {\n      className: \"image is-64x64\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: img,\n      alt: \"Image\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"media-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, React.createElement(\"nav\", {\n      className: \"level is-mobile\",\n      style: {\n        float: \"right\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"level-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      className: \"level-item\",\n      \"aria-label\": \"comment\",\n      onClick: e => this.handleComment(e),\n      style: {\n        marginRight: \"0.25rem\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"icon is-small\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fas fa-comment\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }))), this.deleteControl())), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }, title), React.createElement(\"div\", {\n      style: {\n        float: \"left\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, this.createTagGroup()), React.createElement(\"p\", {\n      style: {\n        float: \"right\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }, React.createElement(\"small\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    }, views, \" Views\"), this.spaceDividor(), React.createElement(\"small\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, comments.length, \" Replies\"))))))), React.createElement(Modal, {\n      open: openComment,\n      onClose: e => this.handleComment(e),\n      center: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207\n      },\n      __self: this\n    }, React.createElement(\"article\", {\n      className: \"media\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208\n      },\n      __self: this\n    }, React.createElement(\"figure\", {\n      className: \"media-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"image is-64x64\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: \"https://versions.bulma.io/0.7.0/images/placeholders/128x128.png\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"media-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"field\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"control\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    }, React.createElement(\"textarea\", {\n      className: \"textarea\",\n      placeholder: \"Add a comment...\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217\n      },\n      __self: this\n    }))), React.createElement(\"nav\", {\n      className: \"level\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"level-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"level-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      className: \"button is-info\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223\n      },\n      __self: this\n    }, \"Submit\"))), React.createElement(\"div\", {\n      className: \"level-right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"level-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      className: \"checkbox\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"checkbox\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229\n      },\n      __self: this\n    }), \" Press enter to submit\"))))))));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    userID: state.persistedReducer.userID,\n    likedPosts: state.persistedReducer.likedPosts,\n    myPosts: state.persistedReducer.myPosts\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    handleLike: (id, liked) => dispatch({\n      type: \"HANDLELIKE\",\n      id: id,\n      liked: liked\n    })\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SimplifiedPost);","map":{"version":3,"sources":["/Users/hantaoliu/Projects/Learning-Platform/techleak/client/src/components/userProfile/userProfileComponent/simplifiedPost.jsx"],"names":["React","Modal","axios","connect","Link","confirmAlert","SimplifiedPost","Component","constructor","props","deleteControl","title","objectID","PostType","userID","myPosts","e","persist","message","buttons","label","onClick","token","localStorage","getItem","headers","Authorization","deletedPostData","delete","process","env","REACT_APP_BACKEND_SERVER","deletedmyPostID","Promise","all","handleCancelClick","console","log","preventDefault","handleDelete","state","openComment","handleComment","bind","handleStopPropagation","spaceDividor","margin","display","createTagGroup","tags","map","tag","setState","stopPropagation","nativeEvent","stopImmediatePropagation","withCredentials","liked","likedPosts","includes","patch","then","res","handleLike","catch","err","render","views","comments","img","marginBottom","padding","float","marginRight","length","mapStateToProps","persistedReducer","mapDispatchToProps","dispatch","id","type"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport Modal from \"react-responsive-modal\";\nimport axios from \"axios\";\nimport { connect } from \"react-redux\";\nimport { Link } from \"react-router-dom\";\nimport { confirmAlert } from \"react-custom-confirm-alert\";\nimport 'react-custom-confirm-alert/src/react-confirm-alert.css'\n\nclass SimplifiedPost extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      openComment: false,\n    };\n    this.handleComment = this.handleComment.bind(this);\n    this.handleStopPropagation = this.handleStopPropagation.bind(this);\n  }\n\n  spaceDividor() {\n    return <div style={{ margin: \"5px\", display: \"inline-block\" }} />;\n  }\n\n  createTagGroup() {\n    const { tags } = this.props;\n    return (\n      <React.Fragment>\n        {tags.map(tag => (\n          <React.Fragment>\n            <a className=\"button is-primary is-small\">\n              <span>{tag}</span>\n            </a>\n            {this.spaceDividor()}\n          </React.Fragment>\n        ))}\n      </React.Fragment>\n    );\n  }\n\n  handleComment(e) {\n    this.setState({ openComment: !this.state.openComment });\n    e.preventDefault();\n  }\n\n  handleStopPropagation(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    e.nativeEvent.stopImmediatePropagation();\n  }\n\n  // delete like posts in the backend\n  handleDelete(e, objectID) {\n    const token = localStorage.getItem(\"token\");\n    const headers = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Token ${token}`,\n        withCredentials: true\n      }\n    };\n\n    const liked = this.props.likedPosts.includes(objectID);\n\n    axios.delete(\n      `${process.env.REACT_APP_BACKEND_SERVER}/api/users/likes/${\n      this.props.userID\n      }?postID=${objectID}`,\n      headers\n    );\n\n    axios\n      .patch(\n        `${process.env.REACT_APP_BACKEND_SERVER}/api/posts/likes/${objectID}`,\n        { liked: liked },\n        headers\n      )\n      .then(res => {\n        this.props.handleLike(objectID, liked);\n      })\n      .catch(err => err);\n  }\n\n  deleteControl = () => {\n    const { title, objectID, PostType, userID, myPosts } = this.props;\n    if (PostType === \"MyPosts\") {\n      return (\n        <a className=\"level-item\"\n          aria-label=\"cancel\"\n          onClick={(e) => {\n            e.persist();\n            confirmAlert({\n              message: 'Your post will be deleted permanently, are you sure to do this?',\n              buttons: [\n                {\n                  label: 'Yes',\n                  onClick: async () => {\n                    const token = localStorage.getItem(\"token\");\n                    const headers = {\n                      headers: {\n                        \"Content-Type\": \"application/json\",\n                        Authorization: `Token ${token}`\n                      }\n                    };\n                    try {\n                      // delete the post in the \"Post\" pool backend\n                      let deletedPostData = axios.delete(\n                        `${process.env.REACT_APP_BACKEND_SERVER}/api/posts/${objectID}`,\n                        headers\n                      )\n                      // delete the post in the author's \"myPost\" backend\n                      let deletedmyPostID = axios.delete(\n                        `${process.env.REACT_APP_BACKEND_SERVER}/api/users/myPosts/${\n                        userID\n                        }?postID=${objectID}`,\n                        headers\n                      )\n                      // waiting for the above two promise to finish\n                      await Promise.all([deletedPostData, deletedmyPostID]);\n                      // handle the front end rendering after one \"myPost\" was deleted\n                      this.props.handleCancelClick(e, objectID, PostType);\n                    } catch (e) {\n                      console.log(e);\n                    }\n                  }\n                },\n                {\n                  label: 'No',\n                  onClick: () => {\n                    console.log(objectID);\n                  }\n                }\n              ]\n            });\n            e.preventDefault();\n          }}\n        >\n\n          <span className=\"icon is-small\">\n            <i className=\"fas fa-times\" />\n          </span>\n        </a>\n      );\n    } else if (PostType === \"MyLikes\") {\n      return (\n        <a\n          className=\"level-item\"\n          aria-label=\"cancel\"\n          onClick={e => {\n            // handle the front end rendering\n            this.props.handleCancelClick(e, objectID, PostType);\n            // handle the backend data stroge in data base\n            this.handleDelete(e, objectID);\n          }}\n        >\n          <span className=\"icon is-small\">\n            <i className=\"fas fa-times\" />\n          </span>\n        </a>\n      );\n    }\n  }\n\n  render() {\n    const { title, views, comments, img, objectID } = this.props;\n    const { openComment } = this.state;\n    return (\n      <div className=\"box\" style={{ marginBottom: \"0.5rem\", padding: \"0.8rem\" }}>\n        <Link to={`/blog/${objectID}`}>\n          <article className=\"media\">\n            <div\n              className=\"media-left\"\n              onClick={e => this.handleStopPropagation(e)}\n            >\n              <figure className=\"image is-64x64\">\n                <img src={img} alt=\"Image\" />\n              </figure>\n            </div>\n            <div className=\"media-content\">\n              <div className=\"content\">\n                <nav className=\"level is-mobile\" style={{ float: \"right\" }}>\n                  <div className=\"level-left\">\n                    <a\n                      className=\"level-item\"\n                      aria-label=\"comment\"\n                      onClick={e => this.handleComment(e)}\n                      style={{ marginRight: \"0.25rem\" }}\n                    >\n                      <span className=\"icon is-small\">\n                        <i className=\"fas fa-comment\" />\n                      </span>\n                    </a>\n                    {this.deleteControl()}\n                  </div>\n                </nav>\n                <div>\n                  <h3>{title}</h3>\n                  <div style={{ float: \"left\" }}>{this.createTagGroup()}</div>\n                  <p style={{ float: \"right\" }}>\n                    <small>{views} Views</small>\n                    {this.spaceDividor()}\n                    <small>{comments.length} Replies</small>\n                  </p>\n                </div>\n              </div>\n            </div>\n          </article>\n        </Link>\n        <Modal open={openComment} onClose={e => this.handleComment(e)} center>\n          <article className=\"media\">\n            <figure className=\"media-left\">\n              <p className=\"image is-64x64\">\n                <img src=\"https://versions.bulma.io/0.7.0/images/placeholders/128x128.png\" />\n              </p>\n            </figure>\n            <div className=\"media-content\">\n              <div className=\"field\">\n                <p className=\"control\">\n                  <textarea className=\"textarea\" placeholder=\"Add a comment...\" />\n                </p>\n              </div>\n              <nav className=\"level\">\n                <div className=\"level-left\">\n                  <div className=\"level-item\">\n                    <a className=\"button is-info\">Submit</a>\n                  </div>\n                </div>\n                <div className=\"level-right\">\n                  <div className=\"level-item\">\n                    <label className=\"checkbox\">\n                      <input type=\"checkbox\" /> Press enter to submit\n                    </label>\n                  </div>\n                </div>\n              </nav>\n            </div>\n          </article>\n        </Modal>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    userID: state.persistedReducer.userID,\n    likedPosts: state.persistedReducer.likedPosts,\n    myPosts: state.persistedReducer.myPosts\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    handleLike: (id, liked) =>\n      dispatch({ type: \"HANDLELIKE\", id: id, liked: liked })\n  };\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(SimplifiedPost);\n"]},"metadata":{},"sourceType":"module"}